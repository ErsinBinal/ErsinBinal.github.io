<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>The Bartender | Convivium_</title>

  <style>
    /* =========================
       GENEL ATMOSFER / CRT VIBE
       ========================= */
    :root{
      --bg: #050505;
      --panel: rgba(0,0,0,0.8);
      --text: #e0e0e0;
      --muted: #999;
      --accent: #ff9900;
      --ok: #0f0;
      --border: #444;
    }

    body {
      background-color: var(--bg);
      color: var(--text);
      font-family: 'Courier New', Courier, monospace;
      margin: 0;
      padding: 0;
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      overflow-x: hidden;
      animation: textShadow 1.6s infinite;
    }

    /* Scanline Efekti (pointer-events: none iyi) */
    body::before {
      content: " ";
      display: block;
      position: fixed;
      inset: 0;
      background:
        linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.1) 50%),
        linear-gradient(90deg, rgba(255, 0, 0, 0.06), rgba(0, 255, 0, 0.02), rgba(0, 0, 255, 0.06));
      z-index: 2;
      background-size: 100% 2px, 3px 100%;
      pointer-events: none;
    }

    /* Hareket azaltma isteyenler iÃ§in (baÅŸ aÄŸrÄ±sÄ± opsiyonel deÄŸil ğŸ˜„) */
    @media (prefers-reduced-motion: reduce) {
      body { animation: none; }
      body::before { display: none; }
      .options-grid { animation: none; }
      .result-card { animation: none; }
    }

    nav { position: absolute; top: 20px; left: 20px; z-index: 10; }
    nav a {
      color: var(--accent);
      text-decoration: none;
      font-weight: bold;
      border: 1px solid var(--accent);
      padding: 8px 15px;
      background: rgba(0,0,0,0.8);
      text-transform: uppercase;
      font-size: 0.8rem;
      letter-spacing: 1px;
      display: inline-block;
    }
    nav a:hover { background: var(--accent); color: #000; box-shadow: 0 0 15px var(--accent); }

    .container {
      width: 90%;
      max-width: 600px;
      text-align: center;
      z-index: 5;
      padding-bottom: 50px;
      position: relative;
    }

    /* =========================
       MONÄ°TÃ–R Ã‡ERÃ‡EVESÄ°
       ========================= */
    .monitor-frame {
      border: 2px solid #333;
      background: #080808;
      padding: 15px;
      margin-bottom: 20px;
      box-shadow: 0 0 20px rgba(255, 153, 0, 0.1);
      position: relative;
      min-height: 180px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .status-badge {
      position: absolute;
      top: 10px;
      right: 10px;
      font-size: 0.7rem;
      color: var(--accent);
      border: 1px solid var(--accent);
      padding: 2px 5px;
      opacity: 0.85;
      background: #000;
    }

    .visual-display {
      font-family: 'Courier New', Courier, monospace;
      font-weight: bold;
      color: var(--accent);
      white-space: pre;
      text-shadow: 0 0 5px var(--accent);
      font-size: 13px;
      line-height: 1.2;
      text-align: center;
      transition: opacity 0.25s ease;
      user-select: none;
    }

    /* =========================
       DÄ°YALOG KUTUSU
       ========================= */
    .dialogue-box {
      border: 1px dashed #555;
      background: var(--panel);
      padding: 20px 15px;
      min-height: 60px;
      margin-bottom: 20px;
      text-align: left;
      position: relative;
    }

    .dialogue-label {
      position: absolute;
      top: -10px;
      left: 10px;
      background: var(--bg);
      color: #777;
      font-size: 0.7rem;
      padding: 0 5px;
    }

    .typing-text { font-size: 1rem; line-height: 1.4; color: #ddd; }

    /* =========================
       SEÃ‡ENEKLER
       ========================= */
    .options-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
      animation: fadeIn 0.5s ease;
    }

    .option-btn {
      background: transparent;
      border: 1px solid var(--border);
      color: var(--muted);
      padding: 15px 10px;
      cursor: pointer;
      font-family: inherit;
      font-size: 0.9rem;
      transition: all 0.2s;
      text-transform: uppercase;
    }

    .option-btn:hover {
      border-color: var(--accent);
      color: var(--accent);
      background: rgba(255, 153, 0, 0.05);
      box-shadow: 0 0 10px rgba(255, 153, 0, 0.1);
    }

    /* YazÄ± yazarken tÄ±klanmasÄ±n */
    .option-btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
      box-shadow: none;
    }

    /* =========================
       SONUÃ‡ KARTI
       ========================= */
    .result-card {
      display: none;
      text-align: left;
      border: 1px solid var(--accent);
      background: #0a0a0a;
      animation: slideUp 0.6s ease;
      margin-top: 20px;
    }

    .result-header {
      background: var(--accent);
      color: #000;
      padding: 10px;
      font-weight: bold;
      display: flex;
      justify-content: space-between;
      font-size: 1rem;
      gap: 10px;
      align-items: center;
    }

    .result-body { padding: 20px; }
    .drink-desc { margin-bottom: 15px; color: #ccc; font-style: italic; font-size: 0.95rem; }

    .recipe-box {
      border-left: 3px solid var(--accent);
      margin: 15px 0;
      color: #aaa;
      font-size: 0.9rem;
      background: rgba(255, 153, 0, 0.03);
      padding: 10px 10px 10px 15px;
    }

    .price-btn {
      display: block;
      width: 100%;
      text-align: center;
      background: #1a1a1a;
      color: #fff;
      padding: 15px;
      text-decoration: none;
      border: 1px dashed #666;
      margin-top: 20px;
      transition: all 0.3s;
      font-size: 0.9rem;
      box-sizing: border-box;
      font-weight: bold;
    }

    .price-btn:hover {
      border-color: var(--ok);
      color: var(--ok);
      background: #001a00;
      box-shadow: 0 0 8px var(--ok);
    }

    .restart-btn {
      margin-top: 15px;
      background: none;
      border: none;
      color: #555;
      cursor: pointer;
      width: 100%;
      padding: 10px;
      font-family: inherit;
    }
    .restart-btn:hover { color: #777; }

    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    @keyframes slideUp { from { transform: translateY(20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
    @keyframes textShadow {
      0% { text-shadow: 0.4px 0 1px rgba(0,30,255,0.5), -0.4px 0 1px rgba(255,0,80,0.3), 0 0 3px; }
      50% { text-shadow: 2.7px 0 1px rgba(0,30,255,0.5), -2.7px 0 1px rgba(255,0,80,0.3), 0 0 3px; }
      100% { text-shadow: 0.4px 0 1px rgba(0,30,255,0.5), -0.4px 0 1px rgba(255,0,80,0.3), 0 0 3px; }
    }

    @media (max-width: 600px) {
      .options-grid { grid-template-columns: 1fr; }
      .container { padding-top: 60px; }
      .visual-display { font-size: 11px; }
    }
  </style>
</head>

<body>
  <nav>
    <a href="index.html">[ &lt; Geri ]</a>
  </nav>

  <div class="container">
    <div class="monitor-frame">
      <div id="status-badge" class="status-badge">[ BEKLÄ°YOR ]</div>
      <div id="visual-content" class="visual-display" aria-hidden="true"></div>
    </div>

    <!-- aria-live: ekran okuyucular iÃ§in metin deÄŸiÅŸimini duyurur -->
    <div class="dialogue-box" aria-live="polite" aria-atomic="true">
      <span class="dialogue-label">SÄ°STEM MESAJI</span>
      <div id="dialogue-text" class="typing-text"></div>
    </div>

    <div id="options-container" class="options-grid"></div>

    <div id="result-area" class="result-card">
      <div class="result-header">
        <span id="drink-name"></span>
        <!-- %99 yerine hesaplanan bir deÄŸer yazacaÄŸÄ±z -->
        <span id="match-score">MATCH</span>
      </div>

      <div class="result-body">
        <div id="drink-description" class="drink-desc"></div>

        <div class="recipe-box">
          <strong style="color: var(--accent); display:block; margin-bottom:5px;">&gt; REÃ‡ETE:</strong>
          <div id="drink-recipe"></div>
        </div>

        <a id="price-link" href="#" target="_blank" rel="noopener noreferrer" class="price-btn">
          [ ğŸŒ GÃœNCEL FÄ°YAT ARAÅTIRMASI YAP ]
        </a>

        <button id="restart-btn" class="restart-btn" type="button">
          [ &lt; YENÄ°DEN BAÅLAT ]
        </button>
      </div>
    </div>
  </div>

  <script>
    /* =========================================================
       THE BARTENDER - Daha saÄŸlam, daha okunur sÃ¼rÃ¼m
       ========================================================= */

    // ---------------------------
    // 0) DOM yardÄ±mcÄ±larÄ±
    // ---------------------------
    const $ = (sel, root = document) => root.querySelector(sel);

    const visualEl   = $('#visual-content');
    const statusEl   = $('#status-badge');
    const dialogueEl = $('#dialogue-text');
    const optionsEl  = $('#options-container');
    const resultEl   = $('#result-area');

    const drinkNameEl  = $('#drink-name');
    const matchScoreEl = $('#match-score');
    const drinkDescEl  = $('#drink-description');
    const drinkRecipeEl= $('#drink-recipe');
    const priceLinkEl  = $('#price-link');
    const restartBtn   = $('#restart-btn');

    // ---------------------------
    // 1) ASCII FRAMES (GÃœVENLÄ°)
    // ---------------------------
    const bartenderFrames = [
`   .---.
  /     \\
  | O O |
   \\ - /
  /  _  \\
 |  | |  |
 (  |_|  )`,

`   .---.
  /     \\
  | > < |
   \\ o /
  / / \\ \\
 |  \\_/  |
 ( SHAKE )`,

`   .---.
  /     \\
  | - O |
   \\ ~ /
  /  _  \\
 /  / \\  \\
(   |_|   )`
    ];

    const glassArts = {
      rocks:
`   _________
  |         |
  |  ICE    |
  |   O     |
  |_________|
 [ ROCKS GL ]`,

      martini:
`   \\     /
    \\ o /
     \\ /
      |
      |
     _|_
 [ MARTINI ]`,

      highball:
`  |       |
  |   |   |
  |   |   |
  |   O   |
  |_______|
 [ HIGHBALL]`,

      shot:
`   _     _
   \\___/
   |   |
   |___|
  [ SHOT ]`,

      wine:
`    \\   /
     \\ /
      |
      |
     _|_
  [ WINE ]`,

      raki:
`   |     |
   |     |
   |_____|
   |     |
   |_____|
   [ RAKI ]`,

      mule:
`   |~~~~~|
  _|     |
 [_      |
   |_____|
  [ MUG  ]`,

      tiki:
`   /     \\
  |  O O  |
  |   ^   |
   \\  -  /
    -----
   [ TIKI ]`
    };

    // ---------------------------
    // 2) Basit durum yÃ¶netimi
    // ---------------------------
    let frameIndex = 0;
    let animationTimer = null;
    let typingTimer = null;      // typewriter iptali iÃ§in
    let isTyping = false;

    const state = {
      step: 0,
      prefs: {}
    };

    // ---------------------------
    // 3) (Opsiyonel) seed'li random
    //    ?seed=42 -> aynÄ± seÃ§im aynÄ± sonuÃ§
    // ---------------------------
    const seedParam = new URLSearchParams(location.search).get('seed');

    function mulberry32(seed) {
      let a = seed >>> 0;
      return function() {
        a |= 0;
        a = a + 0x6D2B79F5 | 0;
        let t = Math.imul(a ^ a >>> 15, 1 | a);
        t = t + Math.imul(t ^ t >>> 7, 61 | t) ^ t;
        return ((t ^ t >>> 14) >>> 0) / 4294967296;
      };
    }

    const rng = (seedParam && !Number.isNaN(Number(seedParam)))
      ? mulberry32(Number(seedParam))
      : Math.random;

    // ---------------------------
    // 4) Animasyon kontrolÃ¼
    // ---------------------------
    function startBartender() {
      stopBartender();
      animationTimer = setInterval(() => {
        visualEl.innerText = bartenderFrames[frameIndex];
        frameIndex = (frameIndex + 1) % bartenderFrames.length;
      }, 800);
    }

    function stopBartender() {
      if (animationTimer) clearInterval(animationTimer);
      animationTimer = null;
    }

    function setStatus(text, color = 'var(--accent)') {
      statusEl.innerText = `[ ${text} ]`;
      statusEl.style.color = color;
      statusEl.style.borderColor = color;

      // kÃ¼Ã§Ã¼k bir "yeniden tetikleme" hilesi
      statusEl.style.animation = "none";
      statusEl.offsetHeight;
      statusEl.style.animation = "fadeIn 0.5s";
    }

    function showDrinkArt(glassType) {
      stopBartender();

      visualEl.style.opacity = 0;
      window.setTimeout(() => {
        const art = glassArts[glassType] || glassArts.rocks;
        visualEl.innerText = art;

        // Ä°Ã§ki hazÄ±r modunda yeÅŸil
        visualEl.style.opacity = 1;
        visualEl.style.color = "var(--ok)";
        visualEl.style.textShadow = "0 0 10px var(--ok)";
        setStatus("HAZIR", "var(--ok)");
      }, 350);
    }

    // ---------------------------
    // 5) "Typewriter" (iptal edilebilir)
    // ---------------------------
    function typeWriter(text, speed = 20) {
      // Ã–nce varsa eski yazÄ±yÄ± iptal et
      if (typingTimer) clearTimeout(typingTimer);
      typingTimer = null;

      isTyping = true;
      setOptionsEnabled(false);

      return new Promise((resolve) => {
        let i = 0;

        const tick = () => {
          // imleÃ§
          dialogueEl.innerHTML = text.substring(0, i + 1) + '<span style="color: var(--accent)">_</span>';
          i++;

          if (i < text.length) {
            typingTimer = setTimeout(tick, speed);
          } else {
            dialogueEl.innerHTML = text;
            isTyping = false;
            setOptionsEnabled(true);
            resolve();
          }
        };

        tick();
      });
    }

    function setOptionsEnabled(enabled) {
      // Butonlar render olmadan da Ã§aÄŸrÄ±labilir -> sorun yok
      [...optionsEl.querySelectorAll('button.option-btn')].forEach(btn => {
        btn.disabled = !enabled;
      });
    }

    // ---------------------------
    // 6) VeritabanÄ±
    //    (Senin DB aynen duruyor. Sadece "recipe" zaten HTML -> innerHTML OK)
    // ---------------------------
    const drinksDB = [
      { name: "OLD FASHIONED", glass: "rocks", tags: { mood: "deep", taste: "bitter", intensity: "high" }, desc: "Viskinin en saf hali. DÃ¼ÅŸÃ¼nmek ve yavaÅŸ yudumlamak iÃ§in.", recipe: "â€¢ 6cl Burbon<br>â€¢ 1 KÃ¼p Åeker<br>â€¢ Angostura Bitters", query: "viski fiyatlarÄ±" },
      { name: "WHISKEY SOUR", glass: "rocks", tags: { mood: "relax", taste: "sour", intensity: "medium" }, desc: "EkÅŸi, tatlÄ± ve sert. Ä°peksi bir doku.", recipe: "â€¢ 6cl Viski<br>â€¢ 3cl Limon Suyu<br>â€¢ Åeker Åurubu", query: "viski fiyatlarÄ±" },
      { name: "GODFATHER", glass: "rocks", tags: { mood: "deep", taste: "sweet", intensity: "high" }, desc: "Viski ve badem likÃ¶rÃ¼.", recipe: "â€¢ 5cl Viski<br>â€¢ 2.5cl Amaretto", query: "viski amaretto fiyat" },
      { name: "RUSTY NAIL", glass: "rocks", tags: { mood: "deep", taste: "bitter", intensity: "high" }, desc: "Ä°skoÃ§ viskisi ve bal likÃ¶rÃ¼.", recipe: "â€¢ 4.5cl Scotch<br>â€¢ 2.5cl Drambuie", query: "scotch viski drambuie fiyat" },
      { name: "MANHATTAN", glass: "martini", tags: { mood: "classy", taste: "bitter", intensity: "high" }, desc: "New York klasiÄŸi.", recipe: "â€¢ 5cl Ã‡avdar Viski<br>â€¢ 2cl KÄ±rmÄ±zÄ± Vermut<br>â€¢ Bitters", query: "viski vermut fiyat" },
      { name: "MINT JULEP", glass: "mule", tags: { mood: "relax", taste: "herbal", intensity: "medium" }, desc: "GÃ¼neyli ferahlÄ±ÄŸÄ±.", recipe: "â€¢ 6cl Burbon<br>â€¢ Bol Taze Nane<br>â€¢ Åeker", query: "burbon viski fiyat" },

      { name: "NEGRONI", glass: "rocks", tags: { mood: "classy", taste: "bitter", intensity: "high" }, desc: "Ä°talyan asaleti.", recipe: "â€¢ 3cl Cin<br>â€¢ 3cl Campari<br>â€¢ 3cl KÄ±rmÄ±zÄ± Vermut", query: "cin campari vermut" },
      { name: "DRY MARTINI", glass: "martini", tags: { mood: "classy", taste: "sour", intensity: "high" }, desc: "Sek ve keskin.", recipe: "â€¢ 6cl Cin<br>â€¢ 1cl Kuru Vermut<br>â€¢ Zeytin", query: "cin vermut fiyat" },
      { name: "GIN TONIC", glass: "highball", tags: { mood: "relax", taste: "sour", intensity: "medium" }, desc: "Basit ve mÃ¼kemmel.", recipe: "â€¢ 5cl Cin<br>â€¢ 15cl Tonik<br>â€¢ Limon", query: "cin fiyatlarÄ±" },
      { name: "TOM COLLINS", glass: "highball", tags: { mood: "energy", taste: "sour", intensity: "medium" }, desc: "YetiÅŸkin limonatasÄ±.", recipe: "â€¢ 5cl Cin<br>â€¢ 3cl Limon<br>â€¢ Åeker & Soda", query: "cin fiyatlarÄ±" },
      { name: "GIMLET", glass: "martini", tags: { mood: "classy", taste: "sour", intensity: "high" }, desc: "Keskin limon tadÄ±.", recipe: "â€¢ 6cl Cin<br>â€¢ 4cl Misket Limonu Suyu", query: "cin fiyatlarÄ±" },

      { name: "ESPRESSO MARTINI", glass: "martini", tags: { mood: "energy", taste: "sweet", intensity: "high" }, desc: "UyandÄ±rÄ±r ve Ã§arpar.", recipe: "â€¢ 5cl Votka<br>â€¢ 3cl Kahve LikÃ¶rÃ¼<br>â€¢ 1 shot Espresso", query: "votka kahlua fiyat" },
      { name: "MOSCOW MULE", glass: "mule", tags: { mood: "relax", taste: "spicy", intensity: "medium" }, desc: "Zencefil ferahlÄ±ÄŸÄ±.", recipe: "â€¢ 5cl Votka<br>â€¢ Zencefil Gazozu<br>â€¢ Limon", query: "votka ginger beer" },
      { name: "COSMOPOLITAN", glass: "martini", tags: { mood: "classy", taste: "fruity", intensity: "medium" }, desc: "Åehirli ve pembe.", recipe: "â€¢ 4cl Votka<br>â€¢ 2cl Portakal LikÃ¶rÃ¼<br>â€¢ KÄ±zÄ±lcÄ±k suyu", query: "votka cointreau fiyat" },
      { name: "WHITE RUSSIAN", glass: "rocks", tags: { mood: "relax", taste: "creamy", intensity: "low" }, desc: "Kremsi bir rÃ¼ya.", recipe: "â€¢ 5cl Votka<br>â€¢ 2cl Kahve LikÃ¶rÃ¼<br>â€¢ 3cl Krema", query: "votka kahlua fiyat" },
      { name: "BLOODY MARY", glass: "highball", tags: { mood: "adventure", taste: "spicy", intensity: "medium" }, desc: "Domates ve acÄ± sos.", recipe: "â€¢ 5cl Votka<br>â€¢ Domates Suyu<br>â€¢ Tabasco & Tuz & Biber", query: "votka fiyatlarÄ±" },
      { name: "CAIPIROSKA", glass: "rocks", tags: { mood: "energy", taste: "sour", intensity: "high" }, desc: "Brezilya esintisi.", recipe: "â€¢ 5cl Votka<br>â€¢ Misket Limonu<br>â€¢ Esmer Åeker", query: "votka fiyatlarÄ±" },

      { name: "MOJITO", glass: "highball", tags: { mood: "energy", taste: "sour", intensity: "medium" }, desc: "Nane ferahlÄ±ÄŸÄ±.", recipe: "â€¢ 5cl Rom<br>â€¢ Nane<br>â€¢ Åeker & Soda", query: "beyaz rom fiyat" },
      { name: "CUBA LIBRE", glass: "highball", tags: { mood: "relax", taste: "sweet", intensity: "medium" }, desc: "Rom ve kola.", recipe: "â€¢ 5cl Rom<br>â€¢ Kola<br>â€¢ Limon", query: "rom fiyatlarÄ±" },
      { name: "DAIQUIRI", glass: "martini", tags: { mood: "classy", taste: "sour", intensity: "high" }, desc: "Sade ve gÃ¼Ã§lÃ¼.", recipe: "â€¢ 6cl Rom<br>â€¢ 3cl Limon<br>â€¢ 2cl Åeker", query: "beyaz rom fiyat" },
      { name: "PINA COLADA", glass: "tiki", tags: { mood: "relax", taste: "creamy", intensity: "low" }, desc: "Tropikal tatil.", recipe: "â€¢ 5cl Rom<br>â€¢ Hindistan Cevizi KremasÄ±<br>â€¢ Ananas Suyu", query: "rom malibu fiyat" },
      { name: "MAI TAI", glass: "tiki", tags: { mood: "adventure", taste: "fruity", intensity: "high" }, desc: "Tiki kÃ¼ltÃ¼rÃ¼nÃ¼n kralÄ±.", recipe: "â€¢ 4cl Rom<br>â€¢ 2cl Portakal LikÃ¶rÃ¼<br>â€¢ Badem Åurubu", query: "rom fiyatlarÄ±" },
      { name: "ZOMBIE", glass: "tiki", tags: { mood: "adventure", taste: "fruity", intensity: "high" }, desc: "Ã‡ok sert ve tehlikeli.", recipe: "â€¢ 3 Ã§eÅŸit Rom<br>â€¢ KayÄ±sÄ± LikÃ¶rÃ¼<br>â€¢ Meyve SularÄ±", query: "rom Ã§eÅŸitleri fiyat" },

      { name: "MARGARITA", glass: "martini", tags: { mood: "energy", taste: "sour", intensity: "high" }, desc: "Meksika ateÅŸi.", recipe: "â€¢ 5cl Tekila<br>â€¢ Portakal LikÃ¶rÃ¼<br>â€¢ Limon & Tuz", query: "tekila fiyatlarÄ±" },
      { name: "TEQUILA SUNRISE", glass: "highball", tags: { mood: "relax", taste: "sweet", intensity: "medium" }, desc: "GÃ¼n doÄŸumu renkleri.", recipe: "â€¢ 5cl Tekila<br>â€¢ Portakal Suyu<br>â€¢ Nar Åurubu", query: "tekila fiyatlarÄ±" },
      { name: "PALOMA", glass: "highball", tags: { mood: "relax", taste: "sour", intensity: "medium" }, desc: "Greyfurt ferahlÄ±ÄŸÄ±.", recipe: "â€¢ 5cl Tekila<br>â€¢ Greyfurt Gazozu<br>â€¢ Limon", query: "tekila fiyatlarÄ±" },
      { name: "TEQUILA SHOT", glass: "shot", tags: { mood: "rebel", taste: "sour", intensity: "high" }, desc: "HÄ±zlÄ± Ã§Ã¶zÃ¼m.", recipe: "â€¢ 4cl Tekila<br>â€¢ Tuz<br>â€¢ Limon Dilimi", query: "tekila fiyatlarÄ±" },

      { name: "RAKI (DUBLE)", glass: "raki", tags: { mood: "deep", taste: "herbal", intensity: "high" }, desc: "Aslan sÃ¼tÃ¼.", recipe: "â€¢ Duble RakÄ±<br>â€¢ SoÄŸuk Su<br>â€¢ Peynir & Kavun", query: "rakÄ± fiyatlarÄ±" },
      { name: "RAKI KOKTEYLÄ°", glass: "highball", tags: { mood: "classy", taste: "fruity", intensity: "medium" }, desc: "Modern dokunuÅŸ.", recipe: "â€¢ 5cl RakÄ±<br>â€¢ Nar Suyu<br>â€¢ Nane", query: "rakÄ± fiyatlarÄ±" },
      { name: "JAGER BOMB", glass: "shot", tags: { mood: "rebel", taste: "herbal", intensity: "high" }, desc: "Enerji patlamasÄ±.", recipe: "â€¢ 4cl JÃ¤germeister<br>â€¢ YarÄ±m kutu Enerji Ä°Ã§eceÄŸi", query: "jagermeister fiyat" },
      { name: "ABSINTHE", glass: "wine", tags: { mood: "adventure", taste: "herbal", intensity: "high" }, desc: "YeÅŸil peri.", recipe: "â€¢ 4cl Absinthe<br>â€¢ SoÄŸuk su ile eritilmiÅŸ ÅŸeker", query: "absinthe fiyat" },

      { name: "APEROL SPRITZ", glass: "wine", tags: { mood: "relax", taste: "fruity", intensity: "low" }, desc: "Ä°talyan aperitifi.", recipe: "â€¢ Prosecco<br>â€¢ Aperol<br>â€¢ Soda", query: "aperol fiyatlarÄ±" },
      { name: "MIMOSA", glass: "wine", tags: { mood: "energy", taste: "fruity", intensity: "low" }, desc: "Brunch klasiÄŸi.", recipe: "â€¢ Åampanya<br>â€¢ Portakal Suyu", query: "ÅŸampanya fiyatlarÄ±" },
      { name: "BELLINI", glass: "wine", tags: { mood: "classy", taste: "sweet", intensity: "low" }, desc: "Åeftali rÃ¼yasÄ±.", recipe: "â€¢ Prosecco<br>â€¢ Åeftali PÃ¼resi", query: "prosecco fiyatlarÄ±" },

      { name: "LONG ISLAND", glass: "highball", tags: { mood: "rebel", taste: "sour", intensity: "high" }, desc: "5 Ã§eÅŸit alkol.", recipe: "â€¢ Votka, Cin, Rom, Tekila, LikÃ¶r<br>â€¢ Kola", query: "votka cin rom fiyat" },
      { name: "SAZERAC", glass: "rocks", tags: { mood: "deep", taste: "herbal", intensity: "high" }, desc: "Absinthe ile yÄ±kanmÄ±ÅŸ.", recipe: "â€¢ Ã‡avdar Viski<br>â€¢ Peychaud's<br>â€¢ Absinthe", query: "viski absinthe fiyat" },
      { name: "BOULEVARDIER", glass: "rocks", tags: { mood: "classy", taste: "bitter", intensity: "high" }, desc: "Viskili Negroni.", recipe: "â€¢ Viski<br>â€¢ Campari<br>â€¢ Vermut", query: "viski campari fiyat" }
    ];

    // ---------------------------
    // 7) Soru akÄ±ÅŸÄ±
    // ---------------------------
    const questions = [
      {
        text: "HoÅŸ geldin. Ruh halin nasÄ±l?",
        options: [
          { label: "Sakinlik / Reset", value: "relax" },
          { label: "Enerjik / Parti", value: "energy" },
          { label: "Dertli / Derin", value: "deep" },
          { label: "Sofistike / ÅÄ±k", value: "classy" },
          { label: "MaceracÄ± / Egzotik", value: "adventure" },
          { label: "Asi / Kural TanÄ±maz", value: "rebel" }
        ],
        key: "mood"
      },
      {
        text: "DamaÄŸÄ±nda ne arÄ±yorsun?",
        options: [
          { label: "EkÅŸi ve Ferah", value: "sour" },
          { label: "AcÄ± / Karakterli", value: "bitter" },
          { label: "TatlÄ± / YumuÅŸak", value: "sweet" },
          { label: "Meyvemsi", value: "fruity" },
          { label: "KremamsÄ± / TatlÄ±", value: "creamy" },
          { label: "BaharatlÄ± / Otlu", value: "herbal" },
          { label: "YakÄ±cÄ± / Zencefil", value: "spicy" }
        ],
        key: "taste"
      },
      {
        text: "Son olarak, sertlik derecesi?",
        options: [
          { label: "Hafif (Keyiflik)", value: "low" },
          { label: "Orta (Standart)", value: "medium" },
          { label: "Sert (Ã‡arpsÄ±n)", value: "high" }
        ],
        key: "intensity"
      }
    ];

    // ---------------------------
    // 8) Render
    // ---------------------------
    async function renderStep() {
      optionsEl.innerHTML = "";

      if (state.step < questions.length) {
        const q = questions[state.step];
        setStatus("DÄ°NLÄ°YOR...");

        await typeWriter(q.text, 20);

        // SeÃ§enek butonlarÄ±nÄ± bas
        for (const opt of q.options) {
          const btn = document.createElement('button');
          btn.type = "button";
          btn.className = 'option-btn';
          btn.innerText = `> ${opt.label}`;

          btn.addEventListener('click', () => {
            // YazÄ± yazÄ±yorsa tÄ±klama yok
            if (isTyping) return;
            handleSelection(q.key, opt.value);
          });

          optionsEl.appendChild(btn);
        }
      } else {
        await calculateAndShowResult();
      }
    }

    function handleSelection(key, value) {
      state.prefs[key] = value;
      state.step++;
      renderStep();
    }

    // ---------------------------
    // 9) Skorlama
    //    - AÄŸÄ±rlÄ±klar: mood 5, taste 4, intensity 3
    //    - random: kÃ¼Ã§Ã¼k bir varyans (seed'li olabilir)
    // ---------------------------
    async function calculateAndShowResult() {
      setStatus("HAZIRLIYOR...");
      await typeWriter("Veriler iÅŸleniyor... En uygun karÄ±ÅŸÄ±m taranÄ±yor...", 18);

      // KÃ¼Ã§Ã¼k gecikme = atmosfer
      await new Promise(r => setTimeout(r, 900));

      // SeÃ§enekleri gizle
      optionsEl.style.display = "none";

      let best = drinksDB[0];
      let bestScore = -Infinity;

      for (const drink of drinksDB) {
        let score = 0;

        if (drink.tags.mood === state.prefs.mood) score += 5;
        if (drink.tags.taste === state.prefs.taste) score += 4;
        if (drink.tags.intensity === state.prefs.intensity) score += 3;

        // ufak bir jitter
        score += rng() * 2;

        if (score > bestScore) {
          bestScore = score;
          best = drink;
        }
      }

      showResult(best, bestScore);
    }

    function showResult(drink, score) {
      showDrinkArt(drink.glass);
      resultEl.style.display = "block";

      drinkNameEl.innerText = drink.name;
      drinkDescEl.innerText = drink.desc;
      drinkRecipeEl.innerHTML = drink.recipe;

      // Skordan "match yÃ¼zdesi" tÃ¼retelim (tam bilim deÄŸil, ama %99 sabitinden iyidir)
      // Maks skor kabaca: 5+4+3 + 2 = 14
      const normalized = Math.max(0, Math.min(1, score / 14));
      const matchPct = Math.round(80 + normalized * 19); // 80-99 arasÄ±

      matchScoreEl.innerText = `%${matchPct} MATCH`;

      const searchUrl = `https://www.google.com/search?q=${encodeURIComponent(drink.query + " 2026")}`;
      priceLinkEl.href = searchUrl;

      // Son mesaj
      dialogueEl.innerHTML =
        `<span style="color: var(--accent)">SERVÄ°S EDÄ°LDÄ°:</span><br>` +
        `Senin iÃ§in en iyi seÃ§im: <span style="color: var(--ok)">${drink.name}</span>`;
    }

    // ---------------------------
    // 10) Restart
    // ---------------------------
    restartBtn.addEventListener('click', () => location.reload());

    // ---------------------------
    // 11) BaÅŸlat
    // ---------------------------
    window.addEventListener('DOMContentLoaded', () => {
      startBartender();
      renderStep();
    });
  </script>
</body>
</html>
