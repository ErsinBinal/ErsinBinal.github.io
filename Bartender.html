<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>The Bartender | Convivium_</title>

  <style>
    /* =========================================================
       90s / C64 / Atari Spirit (kÄ±sÄ±tlÄ± imkan estetiÄŸi)
       - DÃ¼z renk + dither pattern
       - Sert kÃ¶ÅŸe + double border
       - Hover palette swap
       ========================================================= */
    :root{
      --bg:#0b0b12;
      --panel:#131328;
      --panel2:#1a1a33;

      --text:#e7e2ff;
      --muted:#a9a2d8;

      --accent:#7cff6b;
      --accent2:#ffcc66;
      --ok:#7cff6b;

      --border:#6b66a8;
      --px:2px;
    }

    body{
      background: var(--bg);
      color: var(--text);
      font-family: ui-monospace, Menlo, Monaco, Consolas, "Courier New", monospace;
      margin:0;
      padding:0;
      min-height:100vh;
      display:flex;
      align-items:center;
      justify-content:center;
      overflow-x:hidden;
      letter-spacing: .2px;
    }

    /* Dither background */
    body::before{
      content:"";
      position:fixed;
      inset:0;
      z-index:1;
      pointer-events:none;
      opacity:.34;
      background:
        radial-gradient(circle at 1px 1px, rgba(255,255,255,.05) 1px, transparent 1.2px) 0 0/6px 6px,
        radial-gradient(circle at 2px 2px, rgba(124,255,107,.05) 1px, transparent 1.2px) 0 0/10px 10px;
    }
    body::after{
      content:"";
      position:fixed;
      inset:0;
      z-index:2;
      pointer-events:none;
      opacity:.10;
      background: repeating-linear-gradient(
        to bottom,
        rgba(0,0,0,0) 0px,
        rgba(0,0,0,0) 2px,
        rgba(0,0,0,.35) 3px
      );
    }

    nav{
      position:absolute;
      top:16px;
      left:16px;
      z-index:10;
    }
    nav a{
      color: var(--accent2);
      text-decoration:none;
      font-weight:bold;
      border: var(--px) solid var(--accent2);
      padding:8px 12px;
      background:#000;
      text-transform: uppercase;
      font-size:.78rem;
      box-shadow:
        0 0 0 var(--px) #000,
        0 0 0 calc(var(--px) * 2) rgba(255,204,102,.15);
    }
    nav a:hover{
      background: var(--accent2);
      color:#000;
      box-shadow:
        0 0 0 var(--px) #000,
        0 0 0 calc(var(--px) * 2) rgba(124,255,107,.25);
    }

    .container{
      width:92%;
      max-width:600px;
      z-index:5;
      padding-bottom:50px;
      position:relative;
    }

    /* Monitor frame: retro window */
    .monitor-frame{
      border: var(--px) solid var(--border);
      background: var(--panel);
      padding:14px;
      margin-bottom:16px;
      position:relative;
      min-height:190px;
      display:flex;
      align-items:center;
      justify-content:center;
      box-shadow: 0 0 0 var(--px) #000;
    }
    .monitor-frame::before{
      content:"";
      position:absolute;
      inset:8px;
      border: var(--px) solid rgba(255,255,255,.08);
      pointer-events:none;
    }

    .status-badge{
      position:absolute;
      top:10px;
      right:10px;
      font-size:.72rem;
      color: var(--accent2);
      border: var(--px) solid var(--accent2);
      padding:2px 6px;
      opacity:.95;
      background:#000;
      text-transform: uppercase;
      letter-spacing:.6px;
    }

    .visual-display{
      font-weight:900;
      color: var(--accent);
      white-space: pre;
      font-size:13px;
      line-height:1.2;
      text-align:center;

      /* â€œpixel outline glowâ€ (blur yok) */
      text-shadow:
        1px 0 0 rgba(0,0,0,.9),
        -1px 0 0 rgba(0,0,0,.9),
        0 1px 0 rgba(0,0,0,.9),
        0 -1px 0 rgba(0,0,0,.9);

      -webkit-font-smoothing: none;
      -moz-osx-font-smoothing: grayscale;

      user-select:none;
      transition: opacity .12s steps(2), transform .12s steps(2);
    }

    /* Sprite jitter vars */
    .visual-display.shake{
      transform: translate(var(--jx, 0px), var(--jy, 0px));
    }

    .dialogue-box{
      border: var(--px) solid var(--border);
      background: var(--panel2);
      padding:18px 14px;
      min-height:64px;
      margin-bottom:16px;
      text-align:left;
      position:relative;
      box-shadow: 0 0 0 var(--px) #000;
    }
    .dialogue-label{
      position:absolute;
      top:-12px;
      left:10px;
      background: var(--bg);
      color: var(--muted);
      font-size:.72rem;
      padding:0 6px;
      border: var(--px) solid rgba(255,255,255,.08);
      text-transform: uppercase;
    }
    .typing-text{
      font-size:1rem;
      line-height:1.45;
      color: var(--text);
    }

    .options-grid{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:10px;
      animation: popIn .18s steps(2);
    }

    .option-btn{
      background:#000;
      border: var(--px) solid var(--border);
      color: var(--muted);
      padding:14px 10px;
      cursor:pointer;
      font-family:inherit;
      font-size:.88rem;
      text-transform: uppercase;

      box-shadow:
        0 0 0 var(--px) #000,
        inset 0 0 0 var(--px) rgba(255,255,255,.05);

      transition:none; /* retro: keskin */
    }
    .option-btn:hover{
      background: var(--accent);
      color:#000;
      border-color: var(--accent2);
      box-shadow:
        0 0 0 var(--px) #000,
        0 0 0 calc(var(--px) * 2) rgba(124,255,107,.25);
    }
    .option-btn:active{ transform: translateY(2px); }

    .result-card{
      display:none;
      text-align:left;
      border: var(--px) solid var(--accent2);
      background:#000;
      animation: slideUp .22s steps(2);
      margin-top:16px;
      box-shadow: 0 0 0 var(--px) #000;
    }

    .result-header{
      background: var(--accent2);
      color:#000;
      padding:10px;
      font-weight:900;
      display:flex;
      justify-content:space-between;
      font-size:1rem;
      text-transform: uppercase;
      gap:10px;
    }

    .result-body{ padding:18px 16px; }
    .drink-desc{ margin-bottom:14px; color: var(--text); font-style: italic; font-size:.95rem; }

    .recipe-box{
      border: var(--px) solid rgba(255,204,102,.35);
      padding:12px;
      margin:14px 0;
      color: var(--text);
      background: rgba(255,204,102,.06);
    }

    .price-btn{
      display:block;
      width:100%;
      text-align:center;
      background:#000;
      color: var(--accent);
      padding:14px;
      text-decoration:none;
      border: var(--px) dashed rgba(124,255,107,.65);
      margin-top:16px;
      font-size:.9rem;
      box-sizing:border-box;
      font-weight:900;
      text-transform: uppercase;
    }
    .price-btn:hover{
      background: var(--accent);
      color:#000;
      border-color: var(--accent2);
    }

    .restart-btn{
      margin-top:12px;
      background:none;
      border: var(--px) solid rgba(255,255,255,.12);
      color: rgba(255,255,255,.55);
      cursor:pointer;
      width:100%;
      padding:10px;
      font-family:inherit;
      text-transform: uppercase;
    }
    .restart-btn:hover{
      border-color: var(--accent2);
      color: var(--accent2);
      background: rgba(255,204,102,.06);
    }

    @keyframes popIn{
      from{ opacity:0; transform: translateY(6px); }
      to{ opacity:1; transform: translateY(0); }
    }
    @keyframes slideUp{
      from{ transform: translateY(10px); opacity:0; }
      to{ transform: translateY(0); opacity:1; }
    }

    @media (max-width: 600px){
      .options-grid{ grid-template-columns:1fr; }
      .container{ padding-top:60px; }
      .visual-display{ font-size:11px; }
    }
  </style>
</head>

<body>
  <nav>
    <a href="index.html">[ < Geri ]</a>
  </nav>

  <div class="container">
    <div class="monitor-frame">
      <div id="status-badge" class="status-badge">[ BEKLÄ°YOR ]</div>
      <div id="visual-content" class="visual-display"></div>
    </div>

    <div class="dialogue-box">
      <span class="dialogue-label">SÄ°STEM MESAJI</span>
      <div id="dialogue-text" class="typing-text"></div>
    </div>

    <div id="options-container" class="options-grid"></div>

    <div id="result-area" class="result-card">
      <div class="result-header">
        <span id="drink-name"></span>
        <span>%99 MATCH</span>
      </div>
      <div class="result-body">
        <div id="drink-description" class="drink-desc"></div>

        <div class="recipe-box">
          <strong style="color:var(--accent2); display:block; margin-bottom:6px;">> REÃ‡ETE:</strong>
          <div id="drink-recipe"></div>
        </div>

        <a id="price-link" href="#" target="_blank" class="price-btn">
          [ ğŸŒ GÃœNCEL FÄ°YAT ARAÅTIRMASI YAP ]
        </a>

        <button id="restart-btn" class="restart-btn" type="button">
          [ < YENÄ°DEN BAÅLAT ]
        </button>
      </div>
    </div>
  </div>

  <script>
    // =========================================================
    // 1) ASCII VERÄ°TABANI (SENÄ°N ORÄ°JÄ°NAL Ä°Ã‡ERÄ°K â€” DOKUNMADIM)
    // =========================================================
    const bartenderFrames = [
`   .---.   
  /     \\  
  | O O |  
   \\ - /   
  /  _  \\  
 |  | |  | 
 (  |_|  ) `,

`   .---.   
  /     \\  
  | > < |  
   \\ o /   
  / / \\ \\  
 |  \\_/  | 
 ( SHAKE ) `,

`   .---.   
  /     \\  
  | - O |  
   \\ ~ /   
  /  _  \\  
 /  / \\  \\ 
(   |_|   )`
    ];

    const glassArts = {
      rocks: 
`   _________
  |         |
  |  ICE    |
  |   O     |
  |_________|
 [ ROCKS GL ]`,

      martini:
`   \\     /
    \\ o /
     \\ /
      |
      |
     _|_
 [ MARTINI ]`,

      highball:
`  |       |
  |   |   |
  |   |   |
  |   O   |
  |_______|
 [ HIGHBALL]`,

      shot:
`   _     _
   \\___/
   |   |
   |___|
  [ SHOT ]`,

      wine:
`    \\   /
     \\ /
      |
      |
     _|_
  [ WINE ]`,

      raki:
`   |     |
   |     |
   |_____|
   |     |
   |_____|
   [ RAKI ]`,
   
      mule:
`   |~~~~~|
  _|     |
 [_      |
   |_____|
  [ MUG  ]`,

      tiki:
`   /     \\
  |  O O  |
  |   ^   |
   \\  -  /
    -----
   [ TIKI ]`
    };

    // =========================================================
    // 2) DOM + STATE
    // =========================================================
    const visualEl   = document.getElementById('visual-content');
    const statusEl   = document.getElementById('status-badge');
    const dialogueBox= document.getElementById('dialogue-text');
    const optionsBox = document.getElementById('options-container');
    const resultArea = document.getElementById('result-area');

    const restartBtn = document.getElementById('restart-btn');

    // =========================================================
    // 3) RETRO ANIMATION ENGINE (rAF + dÃ¼ÅŸÃ¼k fps + sprite jitter)
    //    - Ä°Ã§eriÄŸi deÄŸiÅŸtirmeden sadece "dil" deÄŸiÅŸiyor
    // =========================================================
    const Scene = {
      IDLE:   'IDLE',
      LISTEN: 'LISTEN',
      SCAN:   'SCAN',
      MIX:    'MIX',
      SERVE:  'SERVE'
    };

    const engine = {
      scene: Scene.IDLE,
      frame: 0,
      acc: 0,
      last: performance.now(),
      fps: 6,          // 90'lar vibe: dÃ¼ÅŸÃ¼k fps ama karakterli
      jitter: 0.20,    // sprite jitter olasÄ±lÄ±ÄŸÄ±
      shakeAmp: 1,     // px
      locked: false
    };

    function setStatus(text){
      statusEl.innerText = `[ ${text} ]`;
    }

    function setScene(scene){
      engine.scene = scene;
      engine.frame = 0;
      engine.acc = 0;
      engine.locked = false;

      // sahneye gÃ¶re status
      if (scene === Scene.IDLE)   setStatus("BEKLÄ°YOR");
      if (scene === Scene.LISTEN) setStatus("DÄ°NLÄ°YOR...");
      if (scene === Scene.SCAN)   setStatus("HAZIRLIYOR...");
      if (scene === Scene.MIX)    setStatus("KARIÅTIRIYOR...");
      if (scene === Scene.SERVE)  setStatus("HAZIR");
    }

    function jitterSprite(){
      // sadece bazÄ± frame'lerde 1px kaydÄ±r (retro â€œsprite wobbleâ€)
      if (Math.random() < engine.jitter){
        const jx = (Math.random() < 0.5 ? -1 : 1) * engine.shakeAmp;
        const jy = (Math.random() < 0.3 ? 1 : 0) * engine.shakeAmp;
        visualEl.classList.add('shake');
        visualEl.style.setProperty('--jx', jx + 'px');
        visualEl.style.setProperty('--jy', jy + 'px');
      } else {
        visualEl.classList.remove('shake');
        visualEl.style.setProperty('--jx', '0px');
        visualEl.style.setProperty('--jy', '0px');
      }
    }

    function renderFrame(){
      if (engine.scene === Scene.SERVE) return; // SERVE'de bardak sabit

      // Ã‡ok frame yok: o dÃ¶nemin olayÄ± zaten buydu :)
      // Sahne bazlÄ± kÃ¼Ã§Ã¼k davranÄ±ÅŸ farkÄ±:
      // LISTEN: normal loop
      // SCAN: aynÄ± loop ama jitter daha az
      // MIX: jitter daha fazla (shake hissi)
      if (engine.scene === Scene.SCAN) engine.jitter = 0.10;
      else if (engine.scene === Scene.MIX) engine.jitter = 0.35;
      else engine.jitter = 0.18;

      visualEl.innerText = bartenderFrames[engine.frame % bartenderFrames.length];
      engine.frame++;

      jitterSprite();
    }

    function loop(now){
      const dt = Math.min(0.05, (now - engine.last) / 1000);
      engine.last = now;
      engine.acc += dt;

      const step = 1 / engine.fps;
      while (engine.acc >= step){
        engine.acc -= step;
        renderFrame();
      }
      requestAnimationFrame(loop);
    }

    requestAnimationFrame(loop);

    function showDrinkArt(glassType){
      setScene(Scene.SERVE);

      visualEl.style.opacity = 0;
      setTimeout(() => {
        const art = glassArts[glassType] || glassArts.rocks;
        visualEl.innerText = art;
        visualEl.style.opacity = 1;
        visualEl.style.color = "var(--accent2)";
      }, 120);
    }

    // =========================================================
    // 4) VERÄ°TABANI (SENÄ°N ORÄ°JÄ°NAL â€” DOKUNMADIM)
    // =========================================================
    const drinksDB = [
      // --- KLASÄ°KLER & VÄ°SKÄ° ---
      { name: "OLD FASHIONED", glass: "rocks", tags: { mood: "deep", taste: "bitter", intensity: "high" }, desc: "Viskinin en saf hali. DÃ¼ÅŸÃ¼nmek ve yavaÅŸ yudumlamak iÃ§in.", recipe: "â€¢ 6cl Burbon<br>â€¢ 1 KÃ¼p Åeker<br>â€¢ Angostura Bitters", query: "viski fiyatlarÄ±" },
      { name: "WHISKEY SOUR", glass: "rocks", tags: { mood: "relax", taste: "sour", intensity: "medium" }, desc: "EkÅŸi, tatlÄ± ve sert. Ä°peksi bir doku.", recipe: "â€¢ 6cl Viski<br>â€¢ 3cl Limon Suyu<br>â€¢ Åeker Åurubu", query: "viski fiyatlarÄ±" },
      { name: "GODFATHER", glass: "rocks", tags: { mood: "deep", taste: "sweet", intensity: "high" }, desc: "Viski ve badem likÃ¶rÃ¼.", recipe: "â€¢ 5cl Viski<br>â€¢ 2.5cl Amaretto", query: "viski amaretto fiyat" },
      { name: "RUSTY NAIL", glass: "rocks", tags: { mood: "deep", taste: "bitter", intensity: "high" }, desc: "Ä°skoÃ§ viskisi ve bal likÃ¶rÃ¼.", recipe: "â€¢ 4.5cl Scotch<br>â€¢ 2.5cl Drambuie", query: "scotch viski drambuie fiyat" },
      { name: "MANHATTAN", glass: "martini", tags: { mood: "classy", taste: "bitter", intensity: "high" }, desc: "New York klasiÄŸi.", recipe: "â€¢ 5cl Ã‡avdar Viski<br>â€¢ 2cl KÄ±rmÄ±zÄ± Vermut<br>â€¢ Bitters", query: "viski vermut fiyat" },
      { name: "MINT JULEP", glass: "mule", tags: { mood: "relax", taste: "herbal", intensity: "medium" }, desc: "GÃ¼neyli ferahlÄ±ÄŸÄ±.", recipe: "â€¢ 6cl Burbon<br>â€¢ Bol Taze Nane<br>â€¢ Åeker", query: "burbon viski fiyat" },

      // --- CÄ°N & SOFÄ°STÄ°KE ---
      { name: "NEGRONI", glass: "rocks", tags: { mood: "classy", taste: "bitter", intensity: "high" }, desc: "Ä°talyan asaleti.", recipe: "â€¢ 3cl Cin<br>â€¢ 3cl Campari<br>â€¢ 3cl KÄ±rmÄ±zÄ± Vermut", query: "cin campari vermut" },
      { name: "DRY MARTINI", glass: "martini", tags: { mood: "classy", taste: "sour", intensity: "high" }, desc: "Sek ve keskin.", recipe: "â€¢ 6cl Cin<br>â€¢ 1cl Kuru Vermut<br>â€¢ Zeytin", query: "cin vermut fiyat" },
      { name: "GIN TONIC", glass: "highball", tags: { mood: "relax", taste: "sour", intensity: "medium" }, desc: "Basit ve mÃ¼kemmel.", recipe: "â€¢ 5cl Cin<br>â€¢ 15cl Tonik<br>â€¢ Limon", query: "cin fiyatlarÄ±" },
      { name: "TOM COLLINS", glass: "highball", tags: { mood: "energy", taste: "sour", intensity: "medium" }, desc: "YetiÅŸkin limonatasÄ±.", recipe: "â€¢ 5cl Cin<br>â€¢ 3cl Limon<br>â€¢ Åeker & Soda", query: "cin fiyatlarÄ±" },
      { name: "GIMLET", glass: "martini", tags: { mood: "classy", taste: "sour", intensity: "high" }, desc: "Keskin limon tadÄ±.", recipe: "â€¢ 6cl Cin<br>â€¢ 4cl Misket Limonu Suyu", query: "cin fiyatlarÄ±" },

      // --- VOTKA & EÄLENCE ---
      { name: "ESPRESSO MARTINI", glass: "martini", tags: { mood: "energy", taste: "sweet", intensity: "high" }, desc: "UyandÄ±rÄ±r ve Ã§arpar.", recipe: "â€¢ 5cl Votka<br>â€¢ 3cl Kahve LikÃ¶rÃ¼<br>â€¢ 1 shot Espresso", query: "votka kahlua fiyat" },
      { name: "MOSCOW MULE", glass: "mule", tags: { mood: "relax", taste: "spicy", intensity: "medium" }, desc: "Zencefil ferahlÄ±ÄŸÄ±.", recipe: "â€¢ 5cl Votka<br>â€¢ Zencefil Gazozu<br>â€¢ Limon", query: "votka ginger beer" },
      { name: "COSMOPOLITAN", glass: "martini", tags: { mood: "classy", taste: "fruity", intensity: "medium" }, desc: "Åehirli ve pembe.", recipe: "â€¢ 4cl Votka<br>â€¢ 2cl Portakal LikÃ¶rÃ¼<br>â€¢ KÄ±zÄ±lcÄ±k suyu", query: "votka cointreau fiyat" },
      { name: "WHITE RUSSIAN", glass: "rocks", tags: { mood: "relax", taste: "creamy", intensity: "low" }, desc: "Kremsi bir rÃ¼ya.", recipe: "â€¢ 5cl Votka<br>â€¢ 2cl Kahve LikÃ¶rÃ¼<br>â€¢ 3cl Krema", query: "votka kahlua fiyat" },
      { name: "BLOODY MARY", glass: "highball", tags: { mood: "adventure", taste: "spicy", intensity: "medium" }, desc: "Domates ve acÄ± sos.", recipe: "â€¢ 5cl Votka<br>â€¢ Domates Suyu<br>â€¢ Tabasco & Tuz & Biber", query: "votka fiyatlarÄ±" },
      { name: "CAIPIROSKA", glass: "rocks", tags: { mood: "energy", taste: "sour", intensity: "high" }, desc: "Brezilya esintisi.", recipe: "â€¢ 5cl Votka<br>â€¢ Misket Limonu<br>â€¢ Esmer Åeker", query: "votka fiyatlarÄ±" },

      // --- ROM & TÄ°KÄ° ---
      { name: "MOJITO", glass: "highball", tags: { mood: "energy", taste: "sour", intensity: "medium" }, desc: "Nane ferahlÄ±ÄŸÄ±.", recipe: "â€¢ 5cl Rom<br>â€¢ Nane<br>â€¢ Åeker & Soda", query: "beyaz rom fiyat" },
      { name: "CUBA LIBRE", glass: "highball", tags: { mood: "relax", taste: "sweet", intensity: "medium" }, desc: "Rom ve kola.", recipe: "â€¢ 5cl Rom<br>â€¢ Kola<br>â€¢ Limon", query: "rom fiyatlarÄ±" },
      { name: "DAIQUIRI", glass: "martini", tags: { mood: "classy", taste: "sour", intensity: "high" }, desc: "Sade ve gÃ¼Ã§lÃ¼.", recipe: "â€¢ 6cl Rom<br>â€¢ 3cl Limon<br>â€¢ 2cl Åeker", query: "beyaz rom fiyat" },
      { name: "PINA COLADA", glass: "tiki", tags: { mood: "relax", taste: "creamy", intensity: "low" }, desc: "Tropikal tatil.", recipe: "â€¢ 5cl Rom<br>â€¢ Hindistan Cevizi KremasÄ±<br>â€¢ Ananas Suyu", query: "rom malibu fiyat" },
      { name: "MAI TAI", glass: "tiki", tags: { mood: "adventure", taste: "fruity", intensity: "high" }, desc: "Tiki kÃ¼ltÃ¼rÃ¼nÃ¼n kralÄ±.", recipe: "â€¢ 4cl Rom<br>â€¢ 2cl Portakal LikÃ¶rÃ¼<br>â€¢ Badem Åurubu", query: "rom fiyatlarÄ±" },
      { name: "ZOMBIE", glass: "tiki", tags: { mood: "adventure", taste: "fruity", intensity: "high" }, desc: "Ã‡ok sert ve tehlikeli.", recipe: "â€¢ 3 Ã§eÅŸit Rom<br>â€¢ KayÄ±sÄ± LikÃ¶rÃ¼<br>â€¢ Meyve SularÄ±", query: "rom Ã§eÅŸitleri fiyat" },

      // --- TEKÄ°LA & MEKSÄ°KA ---
      { name: "MARGARITA", glass: "martini", tags: { mood: "energy", taste: "sour", intensity: "high" }, desc: "Meksika ateÅŸi.", recipe: "â€¢ 5cl Tekila<br>â€¢ Portakal LikÃ¶rÃ¼<br>â€¢ Limon & Tuz", query: "tekila fiyatlarÄ±" },
      { name: "TEQUILA SUNRISE", glass: "highball", tags: { mood: "relax", taste: "sweet", intensity: "medium" }, desc: "GÃ¼n doÄŸumu renkleri.", recipe: "â€¢ 5cl Tekila<br>â€¢ Portakal Suyu<br>â€¢ Nar Åurubu", query: "tekila fiyatlarÄ±" },
      { name: "PALOMA", glass: "highball", tags: { mood: "relax", taste: "sour", intensity: "medium" }, desc: "Greyfurt ferahlÄ±ÄŸÄ±.", recipe: "â€¢ 5cl Tekila<br>â€¢ Greyfurt Gazozu<br>â€¢ Limon", query: "tekila fiyatlarÄ±" },
      { name: "TEQUILA SHOT", glass: "shot", tags: { mood: "rebel", taste: "sour", intensity: "high" }, desc: "HÄ±zlÄ± Ã§Ã¶zÃ¼m.", recipe: "â€¢ 4cl Tekila<br>â€¢ Tuz<br>â€¢ Limon Dilimi", query: "tekila fiyatlarÄ±" },

      // --- YEREL & Ã–ZEL ---
      { name: "RAKI (DUBLE)", glass: "raki", tags: { mood: "deep", taste: "herbal", intensity: "high" }, desc: "Aslan sÃ¼tÃ¼.", recipe: "â€¢ Duble RakÄ±<br>â€¢ SoÄŸuk Su<br>â€¢ Peynir & Kavun", query: "rakÄ± fiyatlarÄ±" },
      { name: "RAKI KOKTEYLÄ°", glass: "highball", tags: { mood: "classy", taste: "fruity", intensity: "medium" }, desc: "Modern dokunuÅŸ.", recipe: "â€¢ 5cl RakÄ±<br>â€¢ Nar Suyu<br>â€¢ Nane", query: "rakÄ± fiyatlarÄ±" },
      { name: "JAGER BOMB", glass: "shot", tags: { mood: "rebel", taste: "herbal", intensity: "high" }, desc: "Enerji patlamasÄ±.", recipe: "â€¢ 4cl JÃ¤germeister<br>â€¢ YarÄ±m kutu Enerji Ä°Ã§eceÄŸi", query: "jagermeister fiyat" },
      { name: "ABSINTHE", glass: "wine", tags: { mood: "adventure", taste: "herbal", intensity: "high" }, desc: "YeÅŸil peri.", recipe: "â€¢ 4cl Absinthe<br>â€¢ SoÄŸuk su ile eritilmiÅŸ ÅŸeker", query: "absinthe fiyat" },

      // --- HAFÄ°F & KÃ–PÃœKLÃœ ---
      { name: "APEROL SPRITZ", glass: "wine", tags: { mood: "relax", taste: "fruity", intensity: "low" }, desc: "Ä°talyan aperitifi.", recipe: "â€¢ Prosecco<br>â€¢ Aperol<br>â€¢ Soda", query: "aperol fiyatlarÄ±" },
      { name: "MIMOSA", glass: "wine", tags: { mood: "energy", taste: "fruity", intensity: "low" }, desc: "Brunch klasiÄŸi.", recipe: "â€¢ Åampanya<br>â€¢ Portakal Suyu", query: "ÅŸampanya fiyatlarÄ±" },
      { name: "BELLINI", glass: "wine", tags: { mood: "classy", taste: "sweet", intensity: "low" }, desc: "Åeftali rÃ¼yasÄ±.", recipe: "â€¢ Prosecco<br>â€¢ Åeftali PÃ¼resi", query: "prosecco fiyatlarÄ±" },

      // --- AÄIR SÄ°KLET ---
      { name: "LONG ISLAND", glass: "highball", tags: { mood: "rebel", taste: "sour", intensity: "high" }, desc: "5 Ã§eÅŸit alkol.", recipe: "â€¢ Votka, Cin, Rom, Tekila, LikÃ¶r<br>â€¢ Kola", query: "votka cin rom fiyat" },
      { name: "SAZERAC", glass: "rocks", tags: { mood: "deep", taste: "herbal", intensity: "high" }, desc: "Absinthe ile yÄ±kanmÄ±ÅŸ.", recipe: "â€¢ Ã‡avdar Viski<br>â€¢ Peychaud's<br>â€¢ Absinthe", query: "viski absinthe fiyat" },
      { name: "BOULEVARDIER", glass: "rocks", tags: { mood: "classy", taste: "bitter", intensity: "high" }, desc: "Viskili Negroni.", recipe: "â€¢ Viski<br>â€¢ Campari<br>â€¢ Vermut", query: "viski campari fiyat" }
    ];

    // =========================================================
    // 5) SORULAR (SENÄ°N ORÄ°JÄ°NAL â€” DOKUNMADIM)
    // =========================================================
    const questions = [
      {
        text: "HoÅŸ geldin. Ruh halin nasÄ±l?",
        options: [
          { label: "Sakinlik / Reset", value: "relax" },
          { label: "Enerjik / Parti", value: "energy" },
          { label: "Dertli / Derin", value: "deep" },
          { label: "Sofistike / ÅÄ±k", value: "classy" },
          { label: "MaceracÄ± / Egzotik", value: "adventure" },
          { label: "Asi / Kural TanÄ±maz", value: "rebel" }
        ],
        key: "mood"
      },
      {
        text: "DamaÄŸÄ±nda ne arÄ±yorsun?",
        options: [
          { label: "EkÅŸi ve Ferah", value: "sour" },
          { label: "AcÄ± / Karakterli", value: "bitter" },
          { label: "TatlÄ± / YumuÅŸak", value: "sweet" },
          { label: "Meyvemsi", value: "fruity" },
          { label: "KremamsÄ± / TatlÄ±", value: "creamy" },
          { label: "BaharatlÄ± / Otlu", value: "herbal" },
          { label: "YakÄ±cÄ± / Zencefil", value: "spicy" }
        ],
        key: "taste"
      },
      {
        text: "Son olarak, sertlik derecesi?",
        options: [
          { label: "Hafif (Keyiflik)", value: "low" },
          { label: "Orta (Standart)", value: "medium" },
          { label: "Sert (Ã‡arpsÄ±n)", value: "high" }
        ],
        key: "intensity"
      }
    ];

    // =========================================================
    // 6) Ä°ÅLEYÄ°Å (SENÄ°N ORÄ°JÄ°NAL â€” sadece sahne geÃ§iÅŸi eklendi)
    // =========================================================
    let currentStep = 0;
    let userPrefs = {};

    function typeWriter(text, i, callback) {
      // retro block cursor
      if (i < text.length) {
        dialogueBox.innerHTML = text.substring(0, i+1) + '<span style="color:var(--accent2)">â–ˆ</span>';
        setTimeout(() => typeWriter(text, i + 1, callback), 18);
      } else {
        dialogueBox.innerHTML = text;
        if (callback) callback();
      }
    }

    function renderStep() {
      optionsBox.innerHTML = "";

      if (currentStep < questions.length) {
        const q = questions[currentStep];

        setScene(Scene.LISTEN);

        typeWriter(q.text, 0, () => {
          q.options.forEach(opt => {
            const btn = document.createElement('button');
            btn.className = 'option-btn';
            btn.innerText = `> ${opt.label}`;
            btn.onclick = () => handleSelection(q.key, opt.value);
            optionsBox.appendChild(btn);
          });
        });
      } else {
        calculateAndShowResult();
      }
    }

    function handleSelection(key, value) {
      userPrefs[key] = value;
      currentStep++;
      renderStep();
    }

    function calculateAndShowResult() {
      setScene(Scene.SCAN);

      typeWriter("Veriler iÅŸleniyor... En uygun karÄ±ÅŸÄ±m taranÄ±yor...", 0, () => {
        setTimeout(() => {
          optionsBox.style.display = 'none';

          // kÄ±sa "mix" sahnesi: 90â€™lar numarasÄ±
          setScene(Scene.MIX);

          setTimeout(() => {
            let bestDrink = null;
            let maxScore = -1;

            drinksDB.forEach(drink => {
              let score = 0;
              if (drink.tags.mood === userPrefs.mood) score += 5;
              if (drink.tags.taste === userPrefs.taste) score += 4;
              if (drink.tags.intensity === userPrefs.intensity) score += 3;
              score += Math.random() * 2;

              if (score > maxScore) {
                maxScore = score;
                bestDrink = drink;
              }
            });

            if (!bestDrink) bestDrink = drinksDB[0];
            showResult(bestDrink);
          }, 550);

        }, 700);
      });
    }

    function showResult(drink) {
      showDrinkArt(drink.glass);

      resultArea.style.display = 'block';

      document.getElementById('drink-name').innerText = drink.name;
      document.getElementById('drink-description').innerText = drink.desc;
      document.getElementById('drink-recipe').innerHTML = drink.recipe;

      const searchUrl = `https://www.google.com/search?q=${encodeURIComponent(drink.query + " 2026")}`;
      const btn = document.getElementById('price-link');
      btn.href = searchUrl;

      dialogueBox.innerHTML = `<span style="color:var(--accent2)">SERVÄ°S EDÄ°LDÄ°:</span><br>Senin iÃ§in en iyi seÃ§im: <span style="color:var(--accent)">${drink.name}</span>`;
    }

    // Start
    window.addEventListener('DOMContentLoaded', () => {
      setScene(Scene.IDLE);
      visualEl.innerText = bartenderFrames[0];
      renderStep();
    });

    restartBtn.addEventListener('click', () => location.reload());
  </script>
</body>
</html>
