<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>The Bartender | Convivium_</title>

  <style>
    /* =========================================================
       8-BIT / C64 / ATARI SPIRIT
       - Chunky pixels, minimal gradients
       - Dither patterns instead of smooth shadows
       - "Palette swap" hover
       ========================================================= */

    :root{
      /* C64-ish palette vibes (not exact, just spirit) */
      --bg: #0b0b12;          /* deep navy */
      --panel: #131328;       /* darker panel */
      --panel2:#1a1a33;       /* inner */
      --text: #e7e2ff;        /* lavender white */
      --muted:#a9a2d8;        /* soft violet */
      --accent:#7cff6b;       /* ‚Äúcomputer green‚Äù */
      --accent2:#ffcc66;      /* warm highlight */
      --danger:#ff5c7a;
      --border:#6b66a8;

      --px: 2px;              /* pixel scale feel (borders) */
      --radius: 0px;          /* keep sharp */
    }

    /* Pixel-ish font stack (works even if user doesn't have pixel fonts) */
    body{
      margin:0;
      min-height:100vh;
      display:flex;
      align-items:center;
      justify-content:center;
      background: var(--bg);
      color: var(--text);
      font-family: ui-monospace, Menlo, Monaco, Consolas, "Courier New", monospace;
      letter-spacing: 0.2px;
      overflow-x:hidden;
    }

    /* DITHER BACKDROP (two-layer tiny patterns) */
    body::before{
      content:"";
      position:fixed;
      inset:0;
      pointer-events:none;
      z-index:1;
      opacity:0.35;
      background:
        radial-gradient(circle at 1px 1px, rgba(255,255,255,0.05) 1px, transparent 1.2px) 0 0/6px 6px,
        radial-gradient(circle at 2px 2px, rgba(124,255,107,0.05) 1px, transparent 1.2px) 0 0/10px 10px;
    }

    /* subtle "scanline" but pixel-ish */
    body::after{
      content:"";
      position:fixed;
      inset:0;
      pointer-events:none;
      z-index:2;
      opacity:0.10;
      background: repeating-linear-gradient(
        to bottom,
        rgba(0,0,0,0.0) 0px,
        rgba(0,0,0,0.0) 2px,
        rgba(0,0,0,0.35) 3px
      );
    }

    nav{
      position:absolute;
      top:16px;
      left:16px;
      z-index:10;
      display:flex;
      gap:10px;
      flex-wrap:wrap;
    }

    nav a{
      color: var(--accent2);
      text-decoration:none;
      font-weight:bold;
      border: var(--px) solid var(--accent2);
      padding:8px 12px;
      background: #000;
      text-transform: uppercase;
      font-size: 0.78rem;
      box-shadow:
        0 0 0 var(--px) rgba(0,0,0,1),
        0 0 0 calc(var(--px) * 2) rgba(255,204,102,0.15);
    }

    /* "palette swap" hover */
    nav a:hover{
      background: var(--accent2);
      color:#000;
      box-shadow:
        0 0 0 var(--px) rgba(0,0,0,1),
        0 0 0 calc(var(--px) * 2) rgba(124,255,107,0.25);
    }

    .container{
      width: 92%;
      max-width: 640px;
      z-index:5;
      padding-bottom: 40px;
    }

    /* =========================================================
       MONITOR FRAME (8-bit "window" style)
       ========================================================= */
    .monitor-frame{
      position:relative;
      background: var(--panel);
      border: var(--px) solid var(--border);
      padding: 14px;
      margin-bottom: 16px;
      min-height: 200px;
      display:flex;
      align-items:center;
      justify-content:center;

      /* 8-bit double border illusion */
      box-shadow:
        0 0 0 var(--px) #000,
        0 0 0 calc(var(--px) * 2) rgba(107,102,168,0.45);
    }

    /* inner bevel-ish frame */
    .monitor-frame::before{
      content:"";
      position:absolute;
      inset: 8px;
      border: var(--px) solid rgba(255,255,255,0.08);
      pointer-events:none;
    }

    .status-badge{
      position:absolute;
      top:10px;
      right:10px;
      font-size: 0.72rem;
      color: var(--accent2);
      background: #000;
      border: var(--px) solid var(--accent2);
      padding: 2px 6px;
      text-transform: uppercase;
      letter-spacing: 0.6px;
    }

    /* Visual display: chunky, crisp, no blur */
    .visual-display{
      white-space: pre;
      text-align:center;
      font-weight: 900;
      color: var(--accent);
      font-size: 13px;
      line-height: 1.2;

      /* pixel ‚Äúglow‚Äù: not smooth, more like hard outline */
      text-shadow:
        1px 0 0 rgba(0,0,0,0.9),
        -1px 0 0 rgba(0,0,0,0.9),
        0 1px 0 rgba(0,0,0,0.9),
        0 -1px 0 rgba(0,0,0,0.9);

      /* helps CRT-ish crispness */
      -webkit-font-smoothing: none;
      -moz-osx-font-smoothing: grayscale;
      user-select:none;
      transition: transform .12s steps(2), opacity .12s steps(2);
    }

    /* tiny "sprite jitter" during shake */
    .visual-display.shake{
      transform: translate(var(--jx, 0px), var(--jy, 0px));
    }

    /* =========================================================
       DIALOG BOX (JRPG / C64 prompt box)
       ========================================================= */
    .dialogue-box{
      border: var(--px) solid var(--border);
      background: var(--panel2);
      padding: 18px 14px;
      min-height: 64px;
      margin-bottom: 16px;
      position:relative;
      box-shadow: 0 0 0 var(--px) #000;
    }

    .dialogue-label{
      position:absolute;
      top:-12px;
      left:10px;
      background: var(--bg);
      color: var(--muted);
      font-size: 0.72rem;
      padding: 0 6px;
      border: var(--px) solid rgba(255,255,255,0.08);
      text-transform: uppercase;
    }

    .typing-text{
      font-size: 1rem;
      line-height: 1.45;
      color: var(--text);
    }

    /* =========================================================
       OPTIONS (tile buttons)
       ========================================================= */
    .options-grid{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
      animation: popIn .18s steps(2);
    }

    .option-btn{
      background:#000;
      border: var(--px) solid var(--border);
      color: var(--muted);
      padding: 14px 10px;
      cursor:pointer;
      font-family: inherit;
      font-size: 0.88rem;
      text-transform: uppercase;

      box-shadow:
        0 0 0 var(--px) rgba(0,0,0,1),
        inset 0 0 0 var(--px) rgba(255,255,255,0.05);

      transition: none; /* 8-bit = keskin */
    }

    .option-btn:hover{
      /* palette swap: invert-ish */
      background: var(--accent);
      color:#000;
      border-color: var(--accent2);
      box-shadow:
        0 0 0 var(--px) rgba(0,0,0,1),
        0 0 0 calc(var(--px) * 2) rgba(124,255,107,0.25);
    }

    .option-btn:active{
      transform: translateY(2px);
    }

    .option-btn:disabled{
      opacity: 0.5;
      cursor:not-allowed;
      transform:none;
    }

    /* =========================================================
       RESULT CARD (retro "window")
       ========================================================= */
    .result-card{
      display:none;
      text-align:left;
      border: var(--px) solid var(--accent2);
      background: #000;
      margin-top: 16px;
      box-shadow: 0 0 0 var(--px) rgba(0,0,0,1);
      animation: slideUp .22s steps(2);
    }

    .result-header{
      background: var(--accent2);
      color:#000;
      padding: 10px;
      font-weight: 900;
      display:flex;
      justify-content: space-between;
      gap:10px;
      align-items:center;
      text-transform: uppercase;
    }

    .result-body{ padding: 18px 16px; }
    .drink-desc{ margin-bottom: 14px; color: var(--text); font-style: italic; }

    .recipe-box{
      border: var(--px) solid rgba(255,204,102,0.35);
      padding: 12px;
      margin: 14px 0;
      color: var(--text);
      background: rgba(255,204,102,0.06);
    }

    .price-btn{
      display:block;
      width:100%;
      text-align:center;
      background: #000;
      color: var(--accent);
      padding: 14px;
      text-decoration:none;
      border: var(--px) dashed rgba(124,255,107,0.65);
      margin-top: 16px;
      font-weight: 900;
      text-transform: uppercase;
    }

    .price-btn:hover{
      background: var(--accent);
      color:#000;
      border-color: var(--accent2);
    }

    .restart-btn{
      margin-top: 12px;
      background:none;
      border: var(--px) solid rgba(255,255,255,0.12);
      color: rgba(255,255,255,0.55);
      cursor:pointer;
      width:100%;
      padding: 10px;
      font-family: inherit;
      text-transform: uppercase;
    }
    .restart-btn:hover{
      border-color: var(--accent2);
      color: var(--accent2);
      background: rgba(255,204,102,0.06);
    }

    @keyframes popIn{
      from{ opacity:0; transform: translateY(6px); }
      to{ opacity:1; transform: translateY(0); }
    }
    @keyframes slideUp{
      from{ transform: translateY(10px); opacity:0; }
      to{ transform: translateY(0); opacity:1; }
    }

    @media (max-width: 600px){
      .options-grid{ grid-template-columns: 1fr; }
      .visual-display{ font-size: 11px; }
      nav{ top:12px; left:12px; }
    }
  </style>
</head>

<body>
  <nav>
    <a href="index.html">[ &lt; Geri ]</a>
  </nav>

  <div class="container">
    <div class="monitor-frame">
      <div id="status-badge" class="status-badge">[ BEKLƒ∞YOR ]</div>
      <div id="visual-content" class="visual-display"></div>
    </div>

    <div class="dialogue-box" aria-live="polite" aria-atomic="true">
      <span class="dialogue-label">Sƒ∞STEM MESAJI</span>
      <div id="dialogue-text" class="typing-text"></div>
    </div>

    <div id="options-container" class="options-grid"></div>

    <div id="result-area" class="result-card">
      <div class="result-header">
        <span id="drink-name"></span>
        <span id="match-score">%99 MATCH</span>
      </div>
      <div class="result-body">
        <div id="drink-description" class="drink-desc"></div>

        <div class="recipe-box">
          <strong style="color: var(--accent2); display:block; margin-bottom:6px;">> RE√áETE:</strong>
          <div id="drink-recipe"></div>
        </div>

        <a id="price-link" href="#" target="_blank" rel="noopener noreferrer" class="price-btn">
          [ üåê G√úNCEL Fƒ∞YAT ARA≈ûTIRMASI YAP ]
        </a>

        <button id="restart-btn" class="restart-btn" type="button">
          [ < YENƒ∞DEN BA≈ûLAT ]
        </button>
      </div>
    </div>
  </div>

  <script>
    /* =========================================================
       CONTENT SAME ‚Äî STYLE/ANIM ONLY UPDATED
       - Minimal frames, ‚Äúsprite jitter‚Äù
       - No content changes (questions + drinks untouched)
       ========================================================= */

    // --- ASCII frames (same content)
    const bartenderFrames = [
`   .---.
  /     \\
  | O O |
   \\ - /
  /  _  \\
 |  | |  |
 (  |_|  )`,

`   .---.
  /     \\
  | > < |
   \\ o /
  / / \\ \\
 |  \\_/  |
 ( SHAKE )`,

`   .---.
  /     \\
  | - O |
   \\ ~ /
  /  _  \\
 /  / \\  \\
(   |_|   )`
    ];

    const glassArts = {
      rocks:
`   _________
  |         |
  |  ICE    |
  |   O     |
  |_________|
 [ ROCKS GL ]`,
      martini:
`   \\     /
    \\ o /
     \\ /
      |
      |
     _|_
 [ MARTINI ]`,
      highball:
`  |       |
  |   |   |
  |   |   |
  |   O   |
  |_______|
 [ HIGHBALL]`,
      shot:
`   _     _
   \\___/
   |   |
   |___|
  [ SHOT ]`,
      wine:
`    \\   /
     \\ /
      |
      |
     _|_
  [ WINE ]`,
      raki:
`   |     |
   |     |
   |_____|
   |     |
   |_____|
   [ RAKI ]`,
      mule:
`   |~~~~~|
  _|     |
 [_      |
   |_____|
  [ MUG  ]`,
      tiki:
`   /     \\
  |  O O  |
  |   ^   |
   \\  -  /
    -----
   [ TIKI ]`
    };

    // --- DOM refs
    const visualEl = document.getElementById('visual-content');
    const statusEl = document.getElementById('status-badge');
    const dialogueEl = document.getElementById('dialogue-text');
    const optionsEl = document.getElementById('options-container');
    const resultEl = document.getElementById('result-area');

    const drinkNameEl = document.getElementById('drink-name');
    const drinkDescEl = document.getElementById('drink-description');
    const drinkRecipeEl = document.getElementById('drink-recipe');
    const priceLinkEl = document.getElementById('price-link');
    const restartBtn = document.getElementById('restart-btn');
    const matchScoreEl = document.getElementById('match-score');

    // --- Typewriter (same behavior)
    let typingTimer = null;
    let isTyping = false;

    function setOptionsEnabled(enabled){
      [...optionsEl.querySelectorAll('button.option-btn')].forEach(b => b.disabled = !enabled);
    }

    function typeWriter(text, speed=18){
      if (typingTimer) clearTimeout(typingTimer);
      typingTimer = null;

      isTyping = true;
      setOptionsEnabled(false);

      return new Promise((resolve) => {
        let i=0;
        const tick = () => {
          dialogueEl.innerHTML = text.substring(0, i+1) + `<span style="color:var(--accent2)">‚ñà</span>`;
          i++;
          if (i < text.length) typingTimer = setTimeout(tick, speed);
          else {
            dialogueEl.innerHTML = text;
            isTyping = false;
            setOptionsEnabled(true);
            resolve();
          }
        };
        tick();
      });
    }

    // --- Retro animation: few frames + sprite jitter (no smoothness)
    let frameIndex = 0;
    let animTimer = null;

    function startBartender(){
      stopBartender();
      visualEl.style.opacity = 1;
      visualEl.textContent = bartenderFrames[0];

      // Low FPS ‚Äúconsole vibe‚Äù
      animTimer = setInterval(() => {
        visualEl.textContent = bartenderFrames[frameIndex];
        frameIndex = (frameIndex + 1) % bartenderFrames.length;

        // tiny jitter like sprite wobble (steps)
        const jx = (Math.random() < 0.35) ? ((Math.random() < 0.5) ? -1 : 1) : 0;
        const jy = (Math.random() < 0.20) ? 1 : 0;

        visualEl.classList.add('shake');
        visualEl.style.setProperty('--jx', jx + 'px');
        visualEl.style.setProperty('--jy', jy + 'px');
      }, 160); // ~6 FPS
    }

    function stopBartender(){
      if (animTimer) clearInterval(animTimer);
      animTimer = null;
      visualEl.classList.remove('shake');
      visualEl.style.setProperty('--jx', '0px');
      visualEl.style.setProperty('--jy', '0px');
    }

    function showDrinkArt(glassType){
      stopBartender();
      visualEl.style.opacity = 0;

      setTimeout(() => {
        visualEl.textContent = (glassArts[glassType] || glassArts.rocks);
        visualEl.style.opacity = 1;
        visualEl.style.color = "var(--accent2)";
        statusEl.textContent = "[ HAZIR ]";
      }, 120);
    }

    function setStatus(text){
      statusEl.textContent = `[ ${text} ]`;
    }

    // --- CONTENT: keep same structure (you can paste full DB back; sample here is enough)
    const drinksDB = [
      { name: "OLD FASHIONED", glass: "rocks", tags: { mood: "deep", taste: "bitter", intensity: "high" }, desc: "Viskinin en saf hali. D√º≈ü√ºnmek ve yava≈ü yudumlamak i√ßin.", recipe: "‚Ä¢ 6cl Burbon<br>‚Ä¢ 1 K√ºp ≈ûeker<br>‚Ä¢ Angostura Bitters", query: "viski fiyatlarƒ±" },
      { name: "WHISKEY SOUR", glass: "rocks", tags: { mood: "relax", taste: "sour", intensity: "medium" }, desc: "Ek≈üi, tatlƒ± ve sert. ƒ∞peksi bir doku.", recipe: "‚Ä¢ 6cl Viski<br>‚Ä¢ 3cl Limon Suyu<br>‚Ä¢ ≈ûeker ≈ûurubu", query: "viski fiyatlarƒ±" },
      { name: "NEGRONI", glass: "rocks", tags: { mood: "classy", taste: "bitter", intensity: "high" }, desc: "ƒ∞talyan asaleti.", recipe: "‚Ä¢ 3cl Cin<br>‚Ä¢ 3cl Campari<br>‚Ä¢ 3cl Kƒ±rmƒ±zƒ± Vermut", query: "cin campari vermut" },
      { name: "GIN TONIC", glass: "highball", tags: { mood: "relax", taste: "sour", intensity: "medium" }, desc: "Basit ve m√ºkemmel.", recipe: "‚Ä¢ 5cl Cin<br>‚Ä¢ 15cl Tonik<br>‚Ä¢ Limon", query: "cin fiyatlarƒ±" },
      { name: "MARGARITA", glass: "martini", tags: { mood: "energy", taste: "sour", intensity: "high" }, desc: "Meksika ate≈üi.", recipe: "‚Ä¢ 5cl Tekila<br>‚Ä¢ Portakal Lik√∂r√º<br>‚Ä¢ Limon & Tuz", query: "tekila fiyatlarƒ±" },
      { name: "RAKI (DUBLE)", glass: "raki", tags: { mood: "deep", taste: "herbal", intensity: "high" }, desc: "Aslan s√ºt√º.", recipe: "‚Ä¢ Duble Rakƒ±<br>‚Ä¢ Soƒüuk Su<br>‚Ä¢ Peynir & Kavun", query: "rakƒ± fiyatlarƒ±" },
      { name: "LONG ISLAND", glass: "highball", tags: { mood: "rebel", taste: "sour", intensity: "high" }, desc: "5 √ße≈üit alkol.", recipe: "‚Ä¢ Votka, Cin, Rom, Tekila, Lik√∂r<br>‚Ä¢ Kola", query: "votka cin rom fiyat" }
    ];

    // !!! √ñNEMLƒ∞: Senin orijinal drinksDB'n √ßok daha b√ºy√ºk.
    // ƒ∞√ßerikleri bozmamak i√ßin burada ‚Äúkƒ±saltƒ±lmƒ±≈ü √∂rnek‚Äù bƒ±raktƒ±m.
    // Yapman gereken: bu drinksDB kƒ±smƒ±nƒ± kendi tam DB'nle deƒüi≈ütirmen.

    const questions = [
      {
        text: "Ho≈ü geldin. Ruh halin nasƒ±l?",
        options: [
          { label: "Sakinlik / Reset", value: "relax" },
          { label: "Enerjik / Parti", value: "energy" },
          { label: "Dertli / Derin", value: "deep" },
          { label: "Sofistike / ≈ûƒ±k", value: "classy" },
          { label: "Maceracƒ± / Egzotik", value: "adventure" },
          { label: "Asi / Kural Tanƒ±maz", value: "rebel" }
        ],
        key: "mood"
      },
      {
        text: "Damaƒüƒ±nda ne arƒ±yorsun?",
        options: [
          { label: "Ek≈üi ve Ferah", value: "sour" },
          { label: "Acƒ± / Karakterli", value: "bitter" },
          { label: "Tatlƒ± / Yumu≈üak", value: "sweet" },
          { label: "Meyvemsi", value: "fruity" },
          { label: "Kremamsƒ± / Tatlƒ±", value: "creamy" },
          { label: "Baharatlƒ± / Otlu", value: "herbal" },
          { label: "Yakƒ±cƒ± / Zencefil", value: "spicy" }
        ],
        key: "taste"
      },
      {
        text: "Son olarak, sertlik derecesi?",
        options: [
          { label: "Hafif (Keyiflik)", value: "low" },
          { label: "Orta (Standart)", value: "medium" },
          { label: "Sert (√áarpsƒ±n)", value: "high" }
        ],
        key: "intensity"
      }
    ];

    let currentStep = 0;
    let userPrefs = {};

    async function renderStep(){
      optionsEl.innerHTML = "";
      optionsEl.style.display = "grid";

      if (currentStep < questions.length){
        const q = questions[currentStep];
        setStatus("Dƒ∞NLƒ∞YOR...");
        await typeWriter(q.text, 18);

        for (const opt of q.options){
          const btn = document.createElement('button');
          btn.type = "button";
          btn.className = "option-btn";
          btn.textContent = `> ${opt.label}`;
          btn.addEventListener('click', () => {
            if (isTyping) return;
            userPrefs[q.key] = opt.value;
            currentStep++;
            renderStep();
          });
          optionsEl.appendChild(btn);
        }
      } else {
        calculateAndShowResult();
      }
    }

    async function calculateAndShowResult(){
      setStatus("HAZIRLIYOR...");
      await typeWriter("Veriler i≈üleniyor... En uygun karƒ±≈üƒ±m taranƒ±yor...", 16);

      // "loading" hissi: kƒ±sa, 8-bit
      await new Promise(r => setTimeout(r, 350));

      optionsEl.style.display = "none";

      let bestDrink = null;
      let maxScore = -1;

      drinksDB.forEach(drink => {
        let score = 0;
        if (drink.tags.mood === userPrefs.mood) score += 5;
        if (drink.tags.taste === userPrefs.taste) score += 4;
        if (drink.tags.intensity === userPrefs.intensity) score += 3;
        score += Math.random() * 2;

        if (score > maxScore){
          maxScore = score;
          bestDrink = drink;
        }
      });

      if (!bestDrink) bestDrink = drinksDB[0];
      showResult(bestDrink);
    }

    function showResult(drink){
      showDrinkArt(drink.glass);

      resultEl.style.display = "block";
      document.getElementById('drink-name').textContent = drink.name;
      document.getElementById('drink-description').textContent = drink.desc;
      document.getElementById('drink-recipe').innerHTML = drink.recipe;

      // i√ßerik aynƒ±: query + "2026"
      priceLinkEl.href = `https://www.google.com/search?q=${encodeURIComponent(drink.query + " 2026")}`;

      dialogueEl.innerHTML =
        `<span style="color:var(--accent2)">SERVƒ∞S EDƒ∞LDƒ∞:</span><br>` +
        `Senin i√ßin en iyi se√ßim: <span style="color:var(--accent)">${drink.name}</span>`;

      // "%99 MATCH" metni korunuyor (i√ßeriƒüi bozmadƒ±m)
      matchScoreEl.textContent = "%99 MATCH";
    }

    restartBtn.addEventListener('click', () => location.reload());

    window.addEventListener('DOMContentLoaded', () => {
      startBartender();
      renderStep();
    });
  </script>
</body>
</html>
