<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8" />
<title>River Raid WebGL</title>
<style>
    html, body {
        margin: 0;
        padding: 0;
        background: #000;
        overflow: hidden;
    }
    canvas {
        display: block;
    }
</style>
</head>
<body>

<canvas id="glCanvas"></canvas>

<script>
/* =====================================================
   BASIC WEBGL SETUP (OpenGL ES mindset)
===================================================== */

const canvas = document.getElementById("glCanvas");
const gl = canvas.getContext("webgl");

if (!gl) {
    alert("WebGL desteklenmiyor, Ã§aÄŸ dÄ±ÅŸÄ± tarayÄ±cÄ± kullanÄ±yorsun ðŸ˜„");
}

function resize() {
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
    gl.viewport(0, 0, canvas.width, canvas.height);
}
window.addEventListener("resize", resize);
resize();

/* =====================================================
   SHADERS
===================================================== */

const vertexShaderSource = `
attribute vec2 a_position;
uniform vec2 u_resolution;

void main() {
    vec2 zeroToOne = a_position / u_resolution;
    vec2 zeroToTwo = zeroToOne * 2.0;
    vec2 clipSpace = zeroToTwo - 1.0;
    gl_Position = vec4(clipSpace * vec2(1, -1), 0, 1);
}
`;

const fragmentShaderSource = `
precision mediump float;
uniform vec4 u_color;
void main() {
    gl_FragColor = u_color;
}
`;

function createShader(type, source) {
    const shader = gl.createShader(type);
    gl.shaderSource(shader, source);
    gl.compileShader(shader);
    return shader;
}

const vertexShader = createShader(gl.VERTEX_SHADER, vertexShaderSource);
const fragmentShader = createShader(gl.FRAGMENT_SHADER, fragmentShaderSource);

const program = gl.createProgram();
gl.attachShader(program, vertexShader);
gl.attachShader(program, fragmentShader);
gl.linkProgram(program);
gl.useProgram(program);

/* =====================================================
   ATTRIBUTES & UNIFORMS
===================================================== */

const positionLocation = gl.getAttribLocation(program, "a_position");
const resolutionLocation = gl.getUniformLocation(program, "u_resolution");
const colorLocation = gl.getUniformLocation(program, "u_color");

const buffer = gl.createBuffer();
gl.bindBuffer(gl.ARRAY_BUFFER, buffer);
gl.enableVertexAttribArray(positionLocation);
gl.vertexAttribPointer(positionLocation, 2, gl.FLOAT, false, 0, 0);

gl.uniform2f(resolutionLocation, canvas.width, canvas.height);

/* =====================================================
   GAME OBJECTS
===================================================== */

const player = {
    x: canvas.width / 2,
    y: canvas.height - 80,
    width: 20,
    height: 30,
    speed: 6
};

let riverOffset = 0;

/* =====================================================
   INPUT
===================================================== */

const keys = {};
window.addEventListener("keydown", e => keys[e.key] = true);
window.addEventListener("keyup", e => keys[e.key] = false);

/* =====================================================
   DRAW HELPERS
===================================================== */

function drawRect(x, y, w, h, color) {
    const vertices = new Float32Array([
        x, y,
        x + w, y,
        x, y + h,
        x, y + h,
        x + w, y,
        x + w, y + h
    ]);
    gl.bufferData(gl.ARRAY_BUFFER, vertices, gl.STATIC_DRAW);
    gl.uniform4fv(colorLocation, color);
    gl.drawArrays(gl.TRIANGLES, 0, 6);
}

/* =====================================================
   GAME LOOP
===================================================== */

function update() {
    if (keys["ArrowLeft"]) player.x -= player.speed;
    if (keys["ArrowRight"]) player.x += player.speed;

    player.x = Math.max(0, Math.min(canvas.width - player.width, player.x));

    riverOffset += 4;
    if (riverOffset > 40) riverOffset = 0;
}

function render() {
    gl.clearColor(0, 0, 0, 1);
    gl.clear(gl.COLOR_BUFFER_BIT);

    /* River */
    for (let i = -1; i < canvas.height / 40 + 1; i++) {
        drawRect(
            canvas.width * 0.25,
            i * 40 + riverOffset,
            canvas.width * 0.5,
            20,
            [0.0, 0.3, 0.6, 1.0]
        );
    }

    /* Player */
    drawRect(
        player.x,
        player.y,
        player.width,
        player.height,
        [1.0, 1.0, 1.0, 1.0]
    );
}

function loop() {
    update();
    render();
    requestAnimationFrame(loop);
}

loop();
</script>

</body>
</html>
