<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>The Cyber-Barista | Convivium_</title>
    
    <script src="https://unpkg.com/@lottiefiles/lottie-player@latest/dist/lottie-player.js"></script>

    <style>
        /* ============================
           1. COFFEE SHOP AESTHETICS
           ============================ */
        :root {
            --bg: #1a1512; /* Çok koyu kahve (neredeyse siyah) */
            --surface: #261e1b;
            --primary: #d4af37; /* Altın Sarısı (Krema Rengi) */
            --accent: #c27e4e; /* Kavrulmuş Kahve Çekirdeği */
            --text-main: #e0d6cc; /* Sütlü Köpük */
            --text-muted: #8c7b70;
            --border: rgba(212, 175, 55, 0.2);
            --font: 'Courier New', Courier, monospace;
        }

        * { box-sizing: border-box; }

        body {
            background-color: var(--bg);
            color: var(--text-main);
            font-family: var(--font);
            margin: 0;
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow-x: hidden;
        }

        /* Kahve Buharı / Duman Efekti (Hafif Arka Plan) */
        body::before {
            content: ""; position: fixed; inset: 0;
            background: 
                radial-gradient(circle at 50% -20%, rgba(212, 175, 55, 0.05), transparent 60%),
                linear-gradient(rgba(0,0,0,0.1) 1px, transparent 1px);
            background-size: 100% 100%, 4px 4px;
            pointer-events: none; z-index: -1;
        }

        .container {
            width: 90%; max-width: 500px; text-align: center;
            position: relative; z-index: 10;
            padding-bottom: 40px;
        }

        nav { position: absolute; top: 20px; left: 20px; }
        nav a { color: var(--text-muted); text-decoration: none; font-size: 0.8rem; text-transform: uppercase; border:1px solid #3e322b; padding:6px 12px; transition:0.3s; background: #110e0c; }
        nav a:hover { color: var(--primary); border-color:var(--primary); }

        /* ============================
           2. BARISTA SAHNESİ (LOTTIE & SVG)
           ============================ */
        .stage-area {
            height: 320px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            background: radial-gradient(circle at bottom, #2a201c, transparent 70%);
            margin-bottom: 20px;
            border-bottom: 4px solid #3e322b;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0,0,0,0.6);
        }

        /* KATMAN 1: SHOT / PORTAFILTER (Animasyon) */
        #anim-brew {
            width: 280px; height: 280px;
            opacity: 0; transform: translateY(-20px);
            transition: all 0.5s;
            position: absolute; top: 10px;
        }

        /* KATMAN 2: BEKLEME (Kahve Çekirdeği Logosu) */
        .idle-logo {
            width: 120px; height: 120px;
            border: 2px solid var(--primary);
            border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            color: var(--primary);
            font-size: 3rem;
            animation: pulseBean 3s infinite ease-in-out;
            box-shadow: 0 0 20px rgba(212, 175, 55, 0.1);
        }

        /* KATMAN 3: SUNUM (Bardak) */
        .presentation-layer {
            position: absolute; bottom: 20px;
            display: flex; flex-direction: column; align-items: center;
            opacity: 0; pointer-events: none; transition: opacity 0.5s;
        }
        
        .coffee-cup-svg {
            width: 140px; height: 140px;
            filter: drop-shadow(0 5px 15px rgba(0,0,0,0.5));
            fill: none; stroke: var(--primary); stroke-width: 2;
        }
        
        /* Duman Efekti */
        .steam {
            position: absolute; top: -40px; width: 60px; height: 60px;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
            filter: blur(8px); opacity: 0;
            animation: rise 3s infinite;
        }

        @keyframes pulseBean { 0%,100% { transform: scale(1); opacity: 0.8; } 50% { transform: scale(1.05); opacity: 1; } }
        @keyframes rise { 0% { transform: translateY(0) scale(1); opacity: 0; } 50% { opacity: 0.4; } 100% { transform: translateY(-40px) scale(1.5); opacity: 0; } }

        /* ============================
           3. UI ELEMANLARI
           ============================ */
        .dialogue-card {
            background: var(--surface); border: 1px solid var(--border);
            border-left: 4px solid var(--primary); padding: 20px;
            margin-bottom: 20px; text-align: left; min-height: 80px;
        }
        .dialogue-header { font-size: 0.6rem; color: var(--text-muted); letter-spacing: 2px; text-transform: uppercase; margin-bottom: 8px; display: block; }
        .typing-text { font-size: 1rem; line-height: 1.5; color: var(--text-main); }

        /* Seçenekler */
        .options-grid { display: grid; grid-template-columns: 1fr; gap: 10px; opacity: 0; animation: fadeIn 0.5s forwards; }
        .option-btn {
            background: rgba(255,255,255,0.03); border: 1px solid #3e322b;
            color: #b0a093; padding: 16px; cursor: pointer;
            font-family: inherit; text-transform: uppercase; font-size: 0.9rem;
            transition: 0.2s; text-align: left; display: flex; justify-content: space-between;
        }
        .option-btn:hover {
            border-color: var(--primary); color: var(--primary);
            background: rgba(212, 175, 55, 0.05); padding-left: 20px;
        }
        .option-btn span { font-size: 0.8em; opacity: 0.5; }

        /* Sonuç Kartı */
        .result-card { display: none; border: 1px solid var(--primary); background: #1a1614; margin-top: 20px; animation: slideUp 0.5s ease; text-align: left; }
        .result-head { background: var(--primary); color: #1a1512; padding: 15px; font-weight: bold; display: flex; justify-content: space-between; font-size: 1.1rem; }
        .result-body { padding: 25px; }
        
        .tag-row { display: flex; gap: 10px; margin-bottom: 15px; }
        .tag { font-size: 0.7rem; background: #3e322b; padding: 4px 8px; border-radius: 4px; color: #ccc; }

        .recipe-block { background: rgba(0,0,0,0.2); padding: 15px; border-left: 2px solid var(--accent); margin-bottom: 20px; }
        .recipe-title { color: var(--accent); font-size: 0.8rem; font-weight: bold; display: block; margin-bottom: 5px; }
        
        .playlist-box { margin-top: 20px; border-top: 1px dashed #3e322b; padding-top: 15px; }
        .song-item { display: flex; align-items: center; font-size: 0.85rem; color: #8c7b70; margin-bottom: 6px; }
        .song-icon { color: var(--primary); margin-right: 8px; }

        .btn-action { display: block; width: 100%; text-align: center; padding: 14px; margin-top: 15px; text-decoration: none; border: 1px solid var(--border); color: var(--primary); font-weight: bold; transition: 0.3s; background: transparent; }
        .btn-action:hover { background: var(--primary); color: #1a1512; }

        @keyframes fadeIn { to { opacity: 1; } }
        @keyframes slideUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>

    <nav><a href="index.html">← Geri Dön</a></nav>

    <svg style="display:none;">
        <defs>
            <path id="cup-hot" d="M20,30 L25,85 Q26,95 36,95 L64,95 Q74,95 75,85 L80,30 Z M20,30 L80,30 M78,40 Q95,40 95,55 Q95,70 77,75" stroke="currentColor" stroke-width="3" fill="none"/>
            <path id="cup-cold" d="M25,90 L20,20 L80,20 L75,90 Z M15,20 L85,20 M30,20 L30,5 M40,20 L40,0 M50,20 L50,10" stroke="currentColor" stroke-width="3" fill="none"/>
            <path id="cup-mug" d="M20,40 L20,85 Q20,95 30,95 L70,95 Q80,95 80,85 L80,40 Z M80,50 Q95,50 95,65 Q95,80 80,80" stroke="currentColor" stroke-width="3" fill="none"/>
        </defs>
    </svg>

    <div class="container">
        
        <div class="stage-area">
            
            <div id="idle-layer">
                <div class="idle-logo">☕</div>
            </div>

            <lottie-player 
                id="anim-brew"
                src="https://lottie.host/93276846-9d32-474d-9e0a-428479e0a8d6/9Q1z3Q5z9p.json" 
                background="transparent" 
                speed="1" 
                loop="true">
            </lottie-player>

            <div id="presentation-layer" class="presentation-layer">
                <div class="steam"></div>
                <svg class="coffee-cup-svg" viewBox="0 0 100 100">
                    <use id="cup-use" href="#cup-hot"></use>
                </svg>
            </div>

        </div>

        <div class="dialogue-card">
            <span class="dialogue-header">THE CYBER-BARISTA AI</span>
            <div id="dialogue-text" class="typing-text"></div>
        </div>

        <div id="options-area" class="options-grid"></div>

        <div id="result-card" class="result-card">
            <div class="result-head">
                <span id="drink-title">KAHVE ADI</span>
                <span>%99 MATCH</span>
            </div>
            <div class="result-body">
                <div class="tag-row">
                    <span class="tag" id="tag-brand">BRAND</span>
                    <span class="tag" id="tag-temp">HOT</span>
                    <span class="tag" id="tag-cal">~150 KCAL</span>
                </div>

                <p id="drink-desc" style="color:#b0a093; margin-bottom:20px; font-style:italic;"></p>
                
                <div class="recipe-block">
                    <span class="recipe-title">> İÇERİK BİLEŞENLERİ:</span>
                    <div id="drink-recipe" style="color:#ddd; font-size:0.9rem;"></div>
                </div>

                <div class="playlist-box">
                    <span class="recipe-title">> MOOD PLAYLIST:</span>
                    <div id="playlist-container"></div>
                </div>
                
                <button onclick="location.reload()" class="btn-action">YENİ SİPARİŞ OLUŞTUR</button>
            </div>
        </div>

    </div>

    <script>
        // --- 1. VERİTABANI (GERÇEK ZİNCİR MENÜLERİ) ---
        // Brand: starbucks, espressolab, nero, kahvedunyasi
        const coffeeDB = [
            // STARBUCKS (Sıcak)
            { name: "White Chocolate Mocha", brand: "Starbucks", temp: "hot", mood: "indulge", taste: "sweet", 
              desc: "Starbucks efsanesi. Beyaz çikolata sosu, espresso ve buharlanmış sütün tatlı buluşması.",
              content: "Espresso (1-2 shot) + Beyaz Çikolata Sosu + Süt + Krema", cal: "350 kcal",
              playlist: ["Sweater Weather - The Neighbourhood", "Coffee - beabadoobee"] },
            
            { name: "Caffè Americano", brand: "Starbucks", temp: "hot", mood: "focus", taste: "bitter", 
              desc: "Espresso ve sıcak su. Basit, yoğun ve kafein dolu.",
              content: "Espresso (2-3 shot) + Sıcak Su", cal: "15 kcal",
              playlist: ["Deep Focus - Spotify", "Lo-Fi Beats - Chill"] },

            // STARBUCKS (Soğuk)
            { name: "Iced White Chocolate Mocha", brand: "Starbucks", temp: "cold", mood: "indulge", taste: "sweet", 
              desc: "Klasik beyaz çikolata lezzetinin buzlu versiyonu.",
              content: "Espresso + Beyaz Çikolata + Süt + Buz + Krema", cal: "300 kcal",
              playlist: ["Summer Vibes - Pop", "Watermelon Sugar - Harry Styles"] },

            { name: "Cold Brew", brand: "Starbucks", temp: "cold", mood: "energy", taste: "bitter", 
              desc: "20 saat soğuk demlenmiş, asiditesi düşük, kafeini yüksek.",
              content: "Özel harman çekirdek + Soğuk Su (20 saat demleme)", cal: "5 kcal",
              playlist: ["Work Hard Play Hard", "Power Workout"] },

            // ESPRESSOLAB (Sıcak)
            { name: "Lotus Latte", brand: "Espressolab", temp: "hot", mood: "indulge", taste: "sweet", 
              desc: "Karamelize bisküvi tadıyla ikonikleşen bir lezzet.",
              content: "Lotus Biscoff Ezmesi + Espresso + Süt + Bisküvi Kırığı", cal: "380 kcal",
              playlist: ["Cozy Autumn - Jazz", "Dream A Little Dream"] },

            { name: "Cortado", brand: "Espressolab", temp: "hot", mood: "focus", taste: "milky", 
              desc: "Espresso ve sütün eşit oranı. Güçlü ama yumuşak.",
              content: "Espresso (Double) + Eşit Miktar Süt", cal: "60 kcal",
              playlist: ["Indie Folk", "Acoustic Covers"] },

            // ESPRESSOLAB (Soğuk)
            { name: "Iced Lotus Latte", brand: "Espressolab", temp: "cold", mood: "indulge", taste: "sweet", 
              desc: "Lotus lezzetinin buz gibi ve ferah hali.",
              content: "Lotus Ezmesi + Espresso + Soğuk Süt + Buz", cal: "350 kcal",
              playlist: ["Chill Hits", "Good Vibes Only"] },

            // CAFFE NERO (Sıcak)
            { name: "Classico Cappuccino", brand: "Caffè Nero", temp: "hot", mood: "relax", taste: "milky", 
              desc: "İtalyan usulü, bol köpüklü ve kakao tozlu.",
              content: "Espresso + Süt + Bol Süt Köpüğü + Kakao", cal: "110 kcal",
              playlist: ["Italian Coffee House", "Dean Martin Essentials"] },

            { name: "Cortado", brand: "Caffè Nero", temp: "hot", mood: "focus", taste: "bitter", 
              desc: "Küçük bardakta yoğun lezzet.",
              content: "1 Shot Espresso + Az Miktar Süt Köpüğü", cal: "40 kcal",
              playlist: ["Reading Soundtrack", "Classical Focus"] },

            // KAHVE DÜNYASI (Sıcak)
            { name: "Türk Kahvesi", brand: "Kahve Dünyası", temp: "hot", mood: "relax", taste: "bitter", 
              desc: "Geleneksel, telveli ve yoğun. Sohbetin bahanesi.",
              content: "İnce Öğütülmüş Türk Kahvesi + Su (+Şeker)", cal: "20 kcal",
              playlist: ["Zeki Müren Klasikleri", "Turkish Psychedelic Rock"] },

            { name: "Sıcak Çikolata", brand: "Kahve Dünyası", temp: "hot", mood: "indulge", taste: "sweet", 
              desc: "Gerçek çikolata parçalarıyla yapılan yoğun kıvam.",
              content: "Eritilmiş Çikolata + Süt", cal: "400 kcal",
              playlist: ["Winter Wonderland", "Christmas Jazz"] },

            // KAHVE DÜNYASI (Soğuk)
            { name: "Soğuk Türk Kahvesi", brand: "Kahve Dünyası", temp: "cold", mood: "energy", taste: "milky", 
              desc: "Geleneksel tadın modern ve serinletici yorumu.",
              content: "Türk Kahvesi + Süt + Buz", cal: "120 kcal",
              playlist: ["Modern Turkish Pop", "Summer Hits TR"] }
        ];

        // --- 2. AKIŞ VE SORULAR ---
        const questions = [
            { 
                text: "Hangi dükkanın önündesin?", 
                key: "brand",
                options: [
                    { l: "Starbucks", v: "Starbucks" },
                    { l: "EspressoLab", v: "Espressolab" },
                    { l: "Caffè Nero", v: "Caffè Nero" },
                    { l: "Kahve Dünyası", v: "Kahve Dünyası" }
                ]
            },
            {
                text: "Hava nasıl? Ne içmek istersin?",
                key: "temp",
                options: [
                    { l: "Sıcak (İçim ısınsın)", v: "hot" },
                    { l: "Soğuk (Ferahlayayım)", v: "cold" }
                ]
            },
            {
                text: "Şu anki modun nedir?",
                key: "mood",
                options: [
                    { l: "Uyanmam Lazım (Enerji)", v: "energy" },
                    { l: "Keyif / Ödül (Tatlı)", v: "indulge" },
                    { l: "Odaklanma / İş (Sade)", v: "focus" },
                    { l: "Rahatlama (Yumuşak)", v: "relax" }
                ]
            }
        ];

        let currentStep = 0;
        let userPrefs = {};

        // DOM Elements
        const dialogue = document.getElementById('dialogue-text');
        const optArea = document.getElementById('options-area');
        const idleLayer = document.getElementById('idle-layer');
        const animBrew = document.getElementById('anim-brew');
        const presentationLayer = document.getElementById('presentation-layer');
        const resultCard = document.getElementById('result-card');
        const cupUse = document.getElementById('cup-use');

        // Typewriter Effect
        function type(txt, cb) {
            dialogue.textContent = "";
            let i = 0;
            let timer = setInterval(() => {
                dialogue.textContent += txt.charAt(i);
                i++;
                if (i >= txt.length) { clearInterval(timer); if(cb) cb(); }
            }, 25);
        }

        function renderStep() {
            optArea.innerHTML = "";
            
            if(currentStep < questions.length) {
                const q = questions[currentStep];
                type(q.text, () => {
                    q.options.forEach(o => {
                        const btn = document.createElement('button');
                        btn.className = 'option-btn';
                        btn.innerHTML = `<span>> ${o.l}</span>`;
                        btn.onclick = () => { userPrefs[q.key] = o.v; currentStep++; renderStep(); };
                        optArea.appendChild(btn);
                    });
                    optArea.style.animation = "fadeIn 0.5s forwards";
                });
            } else {
                calculate();
            }
        }

        function calculate() {
            // Animasyon Başlat
            optArea.style.display = "none";
            idleLayer.style.display = "none";
            animBrew.style.opacity = 1;
            animBrew.play();

            type("Sipariş veriliyor... Kahve demleniyor...", () => {
                setTimeout(() => {
                    // Mantık: Tam eşleşme ara, yoksa markaya ve sıcaklığa göre en yakınını bul
                    let best = coffeeDB.find(c => 
                        c.brand === userPrefs.brand && 
                        c.temp === userPrefs.temp && 
                        c.mood === userPrefs.mood
                    );

                    // Eğer tam mood eşleşmesi yoksa, sadece marka ve sıcaklığa göre ilkini getir
                    if (!best) {
                        best = coffeeDB.find(c => c.brand === userPrefs.brand && c.temp === userPrefs.temp) || coffeeDB[0];
                    }

                    showResult(best);
                }, 2500); // Demleme süresi
            });
        }

        function showResult(coffee) {
            animBrew.style.opacity = 0;
            presentationLayer.style.opacity = 1;

            // Bardak İkonunu Ayarla
            let icon = "#cup-hot";
            if(coffee.temp === "cold") icon = "#cup-cold";
            if(coffee.name.includes("Türk Kahvesi") || coffee.name.includes("Espresso")) icon = "#cup-mug";
            cupUse.setAttribute("href", icon);

            // Sonuçları Yazdır
            resultCard.style.display = "block";
            document.getElementById('drink-title').innerText = coffee.name;
            document.getElementById('tag-brand').innerText = coffee.brand;
            document.getElementById('tag-temp').innerText = coffee.temp === "hot" ? "SICAK" : "SOĞUK";
            document.getElementById('tag-cal').innerText = coffee.cal;
            document.getElementById('drink-desc').innerText = coffee.desc;
            document.getElementById('drink-recipe').innerText = coffee.content;

            // Playlist
            const plBox = document.getElementById('playlist-container');
            plBox.innerHTML = "";
            coffee.playlist.forEach(song => {
                plBox.innerHTML += `<div class="song-item"><span class="song-icon">♪</span> ${song}</div>`;
            });

            dialogue.textContent = "Kahveniz hazır. Buyrun!";
            
            // Video Tavsiyesi (YouTube Linki)
            // Bu kısım, search tool sonucuna göre manuel eklenmiştir
            // Starbucks, Jazz Coffee vb. playlistler için.
            const ytLink = document.createElement('div');
            ytLink.style.marginTop = "15px";
            ytLink.innerHTML = `<a href="https://www.youtube.com/watch?v=uJaYCTCvOcA" target="_blank" style="color:var(--primary); font-size:0.8rem;">[ Cozy Winter Coffee Shop Ambience ]</a>`;
            plBox.appendChild(ytLink);
        }

        window.onload = () => { renderStep(); };

    </script>
</body>
</html>
